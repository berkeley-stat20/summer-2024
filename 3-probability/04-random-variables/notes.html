<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Stat 20 - Random Variables</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../assets/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-WP7F4QKDC8"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-WP7F4QKDC8', { 'anonymize_ip': true});
</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<meta property="og:title" content="Stat 20 - Random Variables">
<meta property="og:description" content="Discrete random variables, probability mass functions, cumulative distribution functions">
<meta property="og:image" content="https://stat20.berkeley.edu/summer-2024/3-probability/04-random-variables/images/roulette-us.jpg">
<meta property="og:site_name" content="Stat 20">
<meta name="twitter:title" content="Stat 20 - Random Variables">
<meta name="twitter:description" content="Discrete random variables, probability mass functions, cumulative distribution functions">
<meta name="twitter:image" content="https://stat20.berkeley.edu/summer-2024/3-probability/04-random-variables/images/roulette-us.jpg">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-sm " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../assets/stat20-hex-small.png" alt="Stat 20 logo" class="navbar-logo"></a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../../syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../office-hours.html"> 
<span class="menu-text">Office Hours</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../notes.html"> 
<span class="menu-text">Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../assignments.html"> 
<span class="menu-text">Assignments</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools tools-wide">
    <a href="https://edstem.org/us/courses/51198" title="" class="quarto-navigation-tool px-1" aria-label="Ed Discussion Forum"><i class="bi bi-chat-fill"></i></a>
    <a href="https://www.gradescope.com/courses/693050" title="" class="quarto-navigation-tool px-1" aria-label="Gradescope"><i class="bi bi-bar-chart-fill"></i></a>
    <a href="https://stat20.datahub.berkeley.edu/" title="" class="quarto-navigation-tool px-1" aria-label="RStudio"><i class="bi bi-r-circle-fill"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#random-variables" id="toc-random-variables" class="nav-link active" data-scroll-target="#random-variables">Random variables</a></li>
  <li>
<a href="#examples-of-random-variables" id="toc-examples-of-random-variables" class="nav-link" data-scroll-target="#examples-of-random-variables">Examples of random variables</a>
  <ul class="collapse">
<li><a href="#discrete-random-variables" id="toc-discrete-random-variables" class="nav-link" data-scroll-target="#discrete-random-variables"><em>Discrete</em> random variables</a></li>
  <li><a href="#continuous-random-variables" id="toc-continuous-random-variables" class="nav-link" data-scroll-target="#continuous-random-variables"><em>Continuous</em> random variables</a></li>
  </ul>
</li>
  <li><a href="#example-making-bets-on-red-in-roulette" id="toc-example-making-bets-on-red-in-roulette" class="nav-link" data-scroll-target="#example-making-bets-on-red-in-roulette">Example: Making bets on red in Roulette</a></li>
  <li>
<a href="#the-probability-distribution-of-a-discrete-random-variable-x" id="toc-the-probability-distribution-of-a-discrete-random-variable-x" class="nav-link" data-scroll-target="#the-probability-distribution-of-a-discrete-random-variable-x">The probability distribution of a discrete random variable <span class="math inline">\(X\)</span></a>
  <ul class="collapse">
<li><a href="#the-probability-mass-function-or-pmf-of-a-discrete-random-variable" id="toc-the-probability-mass-function-or-pmf-of-a-discrete-random-variable" class="nav-link" data-scroll-target="#the-probability-mass-function-or-pmf-of-a-discrete-random-variable">The probability mass function or pmf of a discrete random variable</a></li>
  </ul>
</li>
  <li>
<a href="#some-special-discrete-random-variables-and-their-distributions" id="toc-some-special-discrete-random-variables-and-their-distributions" class="nav-link" data-scroll-target="#some-special-discrete-random-variables-and-their-distributions">Some special discrete random variables and their distributions</a>
  <ul class="collapse">
<li><a href="#the-discrete-uniform-distribution" id="toc-the-discrete-uniform-distribution" class="nav-link" data-scroll-target="#the-discrete-uniform-distribution">The Discrete Uniform Distribution</a></li>
  <li><a href="#the-bernoulli-distribution" id="toc-the-bernoulli-distribution" class="nav-link" data-scroll-target="#the-bernoulli-distribution">The Bernoulli Distribution</a></li>
  <li><a href="#the-binomial-distribution" id="toc-the-binomial-distribution" class="nav-link" data-scroll-target="#the-binomial-distribution">The Binomial Distribution</a></li>
  <li><a href="#the-hypergeometric-distribution" id="toc-the-hypergeometric-distribution" class="nav-link" data-scroll-target="#the-hypergeometric-distribution">The Hypergeometric Distribution</a></li>
  <li><a href="#the-poisson-distribution" id="toc-the-poisson-distribution" class="nav-link" data-scroll-target="#the-poisson-distribution">The Poisson Distribution</a></li>
  </ul>
</li>
  <li><a href="#binomial-vs-hypergeometric-distributions" id="toc-binomial-vs-hypergeometric-distributions" class="nav-link" data-scroll-target="#binomial-vs-hypergeometric-distributions">Binomial vs Hypergeometric distributions</a></li>
  <li><a href="#the-cumulative-distribution-function-fx" id="toc-the-cumulative-distribution-function-fx" class="nav-link" data-scroll-target="#the-cumulative-distribution-function-fx">The cumulative distribution function <span class="math inline">\(F(x)\)</span></a></li>
  <li>
<a href="#ideas-in-code" id="toc-ideas-in-code" class="nav-link" data-scroll-target="#ideas-in-code">Ideas in code</a>
  <ul class="collapse">
<li><a href="#useful-functions" id="toc-useful-functions" class="nav-link" data-scroll-target="#useful-functions">Useful functions</a></li>
  <li><a href="#bernoullip-and-binomialnp" id="toc-bernoullip-and-binomialnp" class="nav-link" data-scroll-target="#bernoullip-and-binomialnp">Bernoulli<span class="math inline">\((p)\)</span> and Binomial<span class="math inline">\((n,p)\)</span></a></li>
  <li><a href="#hypergeometric-n-g-n" id="toc-hypergeometric-n-g-n" class="nav-link" data-scroll-target="#hypergeometric-n-g-n">Hypergeometric <span class="math inline">\((N, G, n)\)</span></a></li>
  <li><a href="#poissonlambda" id="toc-poissonlambda" class="nav-link" data-scroll-target="#poissonlambda">Poisson(<span class="math inline">\(\lambda\)</span>)</a></li>
  </ul>
</li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="notes.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Random Variables</h1>
<p class="subtitle lead">Discrete random variables, probability mass functions, cumulative distribution functions</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p><span class="dropcap">I</span>n the last chapter, we saw that if we want to simulate tossing a fair coin <span class="math inline">\(10\)</span> times, and compute the proportion of times that the coin lands heads, we could use the function <code><a href="https://rdrr.io/r/base/sample.html">sample()</a></code> to sample from <code>(0, 1)</code>, where the outcome “Heads” is represented by the number <code>1</code> and the outcome “Tails” is represented by the number <code>0</code>. Our code might look like:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">tosses_10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fl">10</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">tosses_10</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">tosses_10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0 1 0 0 1 0 0 0 1 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4</code></pre>
</div>
</div>
<p>We used the same idea - of assigning numbers to outcomes when we looked at the probability distribution of the number of heads in three tosses, and when we defined the Bernoulli, binomial, and hypergeometric distributions.</p>
<section id="random-variables" class="level2"><h2 class="anchored" data-anchor-id="random-variables">Random variables</h2>
<p>In each of the above scenarios, we had an outcome space <span class="math inline">\(\Omega\)</span>, and then defined a <strong>function</strong> that assigned a real number to each possible outcome in <span class="math inline">\(\Omega\)</span>. In our simulation above, if <span class="math inline">\(\Omega\)</span> is the set of outcomes <span class="math inline">\(\{\text{``Heads'', ``Tails''}\}\)</span>, we assigned the outcome <span class="math inline">\(\text{``Heads''}\)</span> to the real number <span class="math inline">\(1\)</span>, and the outcome <span class="math inline">\(\text{``Tails''}\)</span> to the real number <span class="math inline">\(0\)</span>. By sampling over and over again from <code>(0,1)</code>, we got a sequence of <span class="math inline">\(0\)</span>’s and <span class="math inline">\(1\)</span>’s that was <em>randomly generated</em> by our sampling. Once we had numbers (instead of sequences of heads and tails), we were able to do operations using these numbers, such as compute the proportion of times we sampled <span class="math inline">\(1\)</span>, or represent the probabilities as a histogram. Moving from non-numeric outcomes in an outcome space <span class="math inline">\(\Omega\)</span> to numbers on the real line is enormously useful.</p>
<p>In mathematical notation:</p>
<p><span class="math display">\[ X : \Omega \rightarrow \mathbb{R}\]</span></p>
<p><span class="math inline">\(X\)</span> is called a <strong><em>random variable</em></strong>: <em>variable</em>, because it takes different values on the real line, and <em>random</em>, because it inherits the randomness from the generating process (in this case, the process is tossing a coin).</p>
<div class="def">
<dl>
<dt><strong>Random variable</strong></dt>
<dd>
A random variable is a function that associates real numbers with outcomes from a random experiment where <span class="math inline">\(\Omega\)</span> is the associated outcome space.
</dd>
</dl>
</div>
<p>The values on the real line that are determined by <span class="math inline">\(X\)</span> have probabilities coming from the probability distribution on <span class="math inline">\(\Omega\)</span>. The <em>range</em> of the random variable <span class="math inline">\(X\)</span> is the set of all the possible values that <span class="math inline">\(X\)</span> can take. We usually denote random variables by <span class="math inline">\(X, Y, \ldots\)</span> or capital letters towards the end of the alphabet. We write statements about the values <span class="math inline">\(X\)</span> takes, such as <span class="math inline">\(X = 1\)</span> or <span class="math inline">\(X = 0\)</span>. Note that <span class="math inline">\(X = 1\)</span> is an <em>event</em> in <span class="math inline">\(\Omega\)</span> consisting of all the outcomes that are mapped to the number <span class="math inline">\(1\)</span> on the real line. The probability of such events is written as <span class="math inline">\(P(X = x)\)</span>, where <span class="math inline">\(x\)</span> is a real number.</p>
<p>Note that we are just formalizing the association of outcomes in <span class="math inline">\(\Omega\)</span> with numbers - an association we have seen before, while defining probability distributions. Earlier we defined probability distributions as how the total probability of <span class="math inline">\(1\)</span> or <span class="math inline">\(100\)</span>% was distributed among all possible outcomes of the random experiment. Now we can extend this definition to the associated real numbers as defined by <span class="math inline">\(X\)</span>.</p>
<div class="def">
<dl>
<dt><strong>Probability distribution of a random variable <span class="math inline">\(X\)</span></strong></dt>
<dd>
The set of possible values of <span class="math inline">\(X\)</span>, along with the associated probabilities, is called the <em>probability distribution</em> for the random variable <span class="math inline">\(X\)</span>.
</dd>
</dl>
</div>
<p>For example, consider the familiar example of the outcome space of three tosses of a fair coin. We can define the random variable <span class="math inline">\(X\)</span> to be the number of heads, and represent it as in the picture below:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/rv-picture.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="600"></p>
</figure>
</div>
<p>Just as with data types, random variables can be classified as <em>discrete</em> or <em>continuous</em>:</p>
<div class="def">
<dl>
<dt><strong>Discrete and continuous random variables</strong></dt>
<dd>
Discrete random variables are restricted to take <em>particular</em> values in an interval, they cannot take just any value, as opposed to continuous random variables which can take any value in some specified interval.
</dd>
</dl>
</div>
</section><section id="examples-of-random-variables" class="level2"><h2 class="anchored" data-anchor-id="examples-of-random-variables">Examples of random variables</h2>
<section id="discrete-random-variables" class="level3"><h3 class="anchored" data-anchor-id="discrete-random-variables">
<em>Discrete</em> random variables</h3>
<ul>
<li>The number of heads in <span class="math inline">\(3\)</span> tosses of a fair coin: The assignment is similar to the outcomes from a single toss, except now we have the possible outcome from tossing a coin three times. For example, the outcome <span class="math inline">\(HHH\)</span> is assigned the number 3, the outcomes <span class="math inline">\(HHT, HTH, THH\)</span> are all assigned the number 2 etc. Note that even though we <em>should</em> write <span class="math inline">\(X(HHH) = 3\)</span>, we don’t. The practice is to ignore the outcome space and just write <span class="math inline">\(X = 3\)</span>.</li>
<li>The number of tosses until the coin lands heads for the first time: If <span class="math inline">\(X\)</span> is the random variable representing the number of tosses until a coin lands heads, the smallest value <span class="math inline">\(X\)</span> can take is 1 (you need at least 1 toss), and there is no upper bound, since in theory, one could keep tossing the coin forever and it could land tails every single time.</li>
<li>The number of people that arrive at an ATM in a day</li>
<li>The number of people in the United States who will have read at least one book in 2024</li>
<li>The number of typos in the Stat 20 notes</li>
</ul></section><section id="continuous-random-variables" class="level3"><h3 class="anchored" data-anchor-id="continuous-random-variables">
<em>Continuous</em> random variables</h3>
<p>In all of the following, we do not restrict the value taken by the random variable.</p>
<ul>
<li>Time between consecutive people arriving at an ATM</li>
<li>Price of a stock</li>
<li>Height of a randomly selected stat 20 student</li>
<li>The weight of a randomly selected newborn baby in California</li>
<li>The amount of rain that falls each March in the Western United States</li>
</ul></section></section><section id="example-making-bets-on-red-in-roulette" class="level2"><h2 class="anchored" data-anchor-id="example-making-bets-on-red-in-roulette">Example: Making bets on red in Roulette</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/roulette-us.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400"></p>
</figure>
</div>
<p>Recall that American roulette wheels have <span class="math inline">\(38\)</span> numbered slots, numbered from <span class="math inline">\(1\)</span> to <span class="math inline">\(36\)</span>, of which <span class="math inline">\(18\)</span> are colored red, and <span class="math inline">\(18\)</span> black. There are two green slots numbered <span class="math inline">\(0\)</span> and a <span class="math inline">\(00\)</span>. As the wheel spins, a ball is sent spinning in the opposite direction. When the wheel slows the ball will land in one of the numbered slots. Players can make various bets on where the ball lands, such as betting on whether the ball will land in a red slot or a black slot. If a player bets one dollar on red, and the ball lands on red, then they win a dollar, in addition to getting their stake of one dollar back. If the ball does not land on red, then they lose their dollar to the casino. Suppose a player bets six times on six consecutive spins, betting on red each time. Their <em>net gain</em> can be defined as the amount they won minus the amount they lost. Is net gain a random variable? What are its possible values (write down how much the player can win or lose in one spin of the wheel, then two, and so on)?</p>
<details><summary>
Check your answer
</summary><p>Yes, net gain <em>is</em> a random variable, and its possible values are: <span class="math inline">\(-6, -4, -2, 0, 2, 4, 6\)</span>. (Why?)</p>
</details></section><section id="the-probability-distribution-of-a-discrete-random-variable-x" class="level2"><h2 class="anchored" data-anchor-id="the-probability-distribution-of-a-discrete-random-variable-x">The probability distribution of a discrete random variable <span class="math inline">\(X\)</span>
</h2>
<p>The list of probabilities associated with each of its values is called the <em>probability distribution</em> of the random variable <span class="math inline">\(X\)</span>. We can list the values and corresponding probability in a table. This table is called the <em>distribution table</em> of the random variable. For example, let <span class="math inline">\(X\)</span> be the number of heads in <span class="math inline">\(3\)</span> tosses of a fair coin. The probability distribution table for <span class="math inline">\(X\)</span> is shown below. The first column should have the possible values that <span class="math inline">\(X\)</span> can take, denoted by <span class="math inline">\(x\)</span>, and the second column should have <span class="math inline">\(P(X = x)\)</span>. Make sure that the probabilities add up to 1! <span class="math inline">\(\displaystyle \sum_x P(X = x) = 1\)</span>.</p>
<table class="table">
<thead><tr class="header">
<th style="text-align: center;"><span class="math inline">\(x\)</span></th>
<th style="text-align: center;"><span class="math inline">\(P(X = x)\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle \frac{1}{8}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle \frac{3}{8}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle \frac{3}{8}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(3\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle \frac{1}{8}\)</span></td>
</tr>
</tbody>
</table>
<section id="the-probability-mass-function-or-pmf-of-a-discrete-random-variable" class="level3"><h3 class="anchored" data-anchor-id="the-probability-mass-function-or-pmf-of-a-discrete-random-variable">The probability mass function or pmf of a discrete random variable</h3>
<div class="def">
<dl>
<dt><strong>Probability mass function (pmf) of a discrete random variable <span class="math inline">\(X\)</span></strong></dt>
<dd>
The <strong>pmf</strong> of a discrete random variable <span class="math inline">\(X\)</span> is defined to be the function <span class="math inline">\(f(x) = P(X = x)\)</span>.
</dd>
</dl>
</div>
<p>We can write down the definition of the function <span class="math inline">\(f(x)\)</span> and it gives the same information as in the table:</p>
<p><span class="math display">\[
f(x) = \begin{cases}
          \frac{1}{8}, \; x = 0, 3 \\
          \frac{3}{8}, \; x = 1, 2
  \end{cases}
\]</span></p>
<p>We see here that <span class="math inline">\(f(x) &gt; 0\)</span> for only <span class="math inline">\(4\)</span> real numbers, and is <span class="math inline">\(0\)</span> otherwise. We can think of the total probability mass as <span class="math inline">\(1\)</span>, and <span class="math inline">\(f(x)\)</span> describes how this mass of <span class="math inline">\(1\)</span> is distributed among the real numbers. It is often easier and more compact to define the probability distribution of <span class="math inline">\(X\)</span> using <span class="math inline">\(f\)</span> rather than the table.</p>
<p>Let’s revisit the special distributions that we have seen so far.</p>
</section></section><section id="some-special-discrete-random-variables-and-their-distributions" class="level2"><h2 class="anchored" data-anchor-id="some-special-discrete-random-variables-and-their-distributions">Some special discrete random variables and their distributions</h2>
<p>For each of the named distributions that we defined earlier, we can define a random variable with that probability distribution.</p>
<section id="the-discrete-uniform-distribution" class="level3"><h3 class="anchored" data-anchor-id="the-discrete-uniform-distribution">The Discrete Uniform Distribution</h3>
<p>Let <span class="math inline">\(X\)</span> take the values <span class="math inline">\(1, 2, 3, \ldots, n\)</span> with <span class="math inline">\(P(X = k) = \displaystyle \frac{1}{n}\)</span> for each of the <span class="math inline">\(k\)</span> from <span class="math inline">\(1\)</span> to <span class="math inline">\(n\)</span>. We call <span class="math inline">\(X\)</span> a <em>discrete uniform</em> random variable with <span class="math inline">\(P(X = k) = \displaystyle \frac{1}{n}\)</span> for <span class="math inline">\(1 \le k \le n\)</span>. Recall that <span class="math inline">\(n\)</span> is the <em>parameter</em> of the discrete uniform distribution, and we write <span class="math inline">\(X \sim\)</span> Discrete Uniform<span class="math inline">\((n)\)</span>.</p>
<section id="example-rolling-a-pair-of-dice-and-summing-the-spots" class="level4"><h4 class="anchored" data-anchor-id="example-rolling-a-pair-of-dice-and-summing-the-spots">Example: Rolling a pair of dice and summing the spots</h4>
<p>Suppose we roll a pair of dice and sum the spots, and let <span class="math inline">\(X\)</span> be the sum. Is <span class="math inline">\(X\)</span> a discrete uniform random variable?</p>
<details><summary>
Check your answer
</summary><p>No.&nbsp;<span class="math inline">\(X\)</span> takes discrete values: <span class="math inline">\(2, 3, 4, \ldots, 12\)</span>, but these are <strong>not</strong> equally likely.</p>
</details></section></section><section id="the-bernoulli-distribution" class="level3"><h3 class="anchored" data-anchor-id="the-bernoulli-distribution">The Bernoulli Distribution</h3>
<p>Recall that the Bernoulli distribution describes the probabilities associated with random binary outcomes that we designate as <em>success</em> and <em>failure</em>, where <span class="math inline">\(p\)</span> is the probability of a <em>success</em>. We can define <span class="math inline">\(X\)</span> be a random variable that takes the value <span class="math inline">\(1\)</span> with probability <span class="math inline">\(p\)</span> and the value <span class="math inline">\(0\)</span> with probability <span class="math inline">\(1-p\)</span>, then <span class="math inline">\(X\)</span> is called a <em>Bernoulli</em> random variable, and it indicates whether the outcome of the random experiment or <em>trial</em> was a sucess or not. We say that <span class="math inline">\(X\)</span> is Bernoulli with parameter <span class="math inline">\(p\)</span>, and write <span class="math inline">\(X \sim\)</span> Bernoulli<span class="math inline">\((p)\)</span>. Below are the same probability histograms that we have seen in the last chapter, but now they describe the probability mass function of <span class="math inline">\(X\)</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/bernoulli.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="500"></p>
</figure>
</div>
</section><section id="the-binomial-distribution" class="level3"><h3 class="anchored" data-anchor-id="the-binomial-distribution">The Binomial Distribution</h3>
<p>Recall that the binomial distribution describes the probabilities of the total number of successes in <span class="math inline">\(n\)</span> independent Bernoulli trials. We let <span class="math inline">\(X\)</span> be this total number of successes (think tossing a coin <span class="math inline">\(n\)</span> times, and counting the number of heads). Then we say that <span class="math inline">\(X\)</span> has the binomial distribution with parameters <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span>, and write <span class="math inline">\(X \sim Bin(n,p)\)</span>, where <span class="math inline">\(X\)</span> takes the values in <span class="math inline">\(\{0, 1, 2, \ldots, n\}\)</span>, and <span class="math display">\[P(X = k ) = \binom{n}{k} p^k (1-p)^{n-k}. \]</span> Recall that the <em>binomial coefficient</em> <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> <span class="math inline">\(\displaystyle \binom{n}{k} = \frac{n!}{k!(n-k)!}.\)</span></p>
<section id="example-proportion-of-likely-voters-in-california-that-prefer-adam-schiff" class="level4"><h4 class="anchored" data-anchor-id="example-proportion-of-likely-voters-in-california-that-prefer-adam-schiff">Example: Proportion of likely voters in California that prefer Adam Schiff</h4>
<p>The top four candidates in the California Senate race will have their final debate on February 20, before the primary elections on March 5, 2024. According to the latest California Elections and Policy Poll, conducted January 21-29, 2024 <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>, Adam Schiff is currently the favorite candidate in the California Senate primary election, preferred by <span class="math inline">\(25\%\)</span> of likely voters. The primary elections will decide the top two candidates (regardless of political affiliation) who will compete in the general election.</p>
<!--Based on the December 2022 report "State of the COVID-19 Pandemic"[^covid], about 35% of Americans reported having at least one positive COVID test. Suppose we survey 10 California residents, sampling them *with* replacement from a database of voters, what is the probability that more than $3$ of the individuals in our sample would have had at least one positive COVID test?-->
<p>Suppose we survey <span class="math inline">\(10\)</span> California residents sampling them <em>with</em> replacement from a database of voters, what is the probability that more than <span class="math inline">\(2\)</span> of the individuals in our sample will prefer Adam Schiff over the other candidates for CA Senator?</p>
<p>In this example, since we are counting the number of voters in our sample that prefer Adam Schiff, such a voter would count as a “success”, because a success is whatever outcome we are counting (regardless of whom we may prefer). We can now set up our random variable <span class="math inline">\(X\)</span>:</p>
<p>Let <span class="math inline">\(X\)</span> be the number of voters in our sample of ten voters who like Adam Schiff best among all the Senatorial candidates in California.</p>
<p>Then <span class="math inline">\(X \sim Bin(10, p = 0.25)\)</span>. (Why are these the parameters?) Using the complement rule,</p>
<p><span class="math inline">\(P(X &gt; 2) = 1 - P(X \le 2) = 1 - \left(P(X = 0) + P(X = 1) + P(X = 2)\right)\)</span>.</p>
<p>Note that since these events are mutually exclusive, we can use the addition rule. This gives us:</p>
<p><span class="math display">\[
\begin{aligned}
P(X &gt; 2) &amp;= 1 - \left(\binom{10}{0}(0.25)^0 (0.75)^{10} + \binom{10}{1}(0.25)^1 (0.75)^9 + \binom{10}{2}(0.25)^2 (0.75)^8 \right)\\
&amp; \approx 0.474\\
\end{aligned}
\]</span> (The symbol <span class="math inline">\(\approx\)</span> denotes <em>approximately equal</em>.) <!--In this chapter, we will have two "Ideas in Code" sections, with the first one introducing the functions in R that we can use for computing the probabilities associated with special distributions. Before we talk about those, we will consider two more special distributions. 

In `R` we can use a special function to compute the binomial probabilities $f(k) = P(X=k)$. It is called `dbinom(x, size, prob)` and takes as input the $k$ that we want (`x`), the number of trials $n$ (`size`), and $p$ (`prob`). In this example, `x` are the values of interest, or 0, 1, 2; `size` is the parameter $n$, which is 10, and `prob` is the probability of a success.


::: {.cell}

```{.r .cell-code  code-fold="false"}
1 - dbinom(0, size = 10, prob = 0.35) - 
  dbinom(1, size = 10, prob = 0.35) - 
  dbinom(2, size = 10, prob = 0.35)
```

::: {.cell-output .cell-output-stdout}

```
[1] 0.7383926
```


:::
:::

--></p>
<p>As stated earlier, we can define <em>events</em> by the <em>values</em> taken by random variables. For example, let <span class="math inline">\(X \sim Bin(10,0.4)\)</span>. In words <span class="math inline">\(X\)</span> counts the number of successes in 10 trials. Given this <span class="math inline">\(X\)</span>, what are the following events in words?</p>
<ul>
<li><span class="math inline">\(X = 5\)</span></li>
<li><span class="math inline">\(X \le 5\)</span></li>
<li><span class="math inline">\(3 \le X \le 8\)</span></li>
</ul>
<p>What are these events in words?</p>
<details><summary>
Check your answer
</summary><p><span class="math inline">\(X\)</span> is the number of successes in ten trials, where the probability of success in each trial is 40%. <span class="math inline">\(X = 5\)</span> is the event that we see exactly five successes in the ten trials, while <span class="math inline">\(X \le 5\)</span> is the event of seeing <em>at most</em> five successes in ten trials. The last event, <span class="math inline">\(3 \le X \le 8\)</span> is the event of at least three successes, but not more than eight, in ten trials.</p>
<!--We will use `dbinom()` to compute the probabilities $P(X = x)$ or the pmf values.


::: {.cell}

```{.r .cell-code  code-fold="false"}
# P(X=5)
dbinom(x = 5, size = 10, prob = 0.4)
```

::: {.cell-output .cell-output-stdout}

```
[1] 0.2006581
```


:::

```{.r .cell-code  code-fold="false"}
# P(X <= 5)
dbinom(x = 0, size = 10, prob = 0.4) + dbinom(x = 1, size = 10, prob = 0.4) + 
  dbinom(x = 2, size = 10, prob = 0.4) + dbinom(x = 3, size = 10, prob = 0.4) +
  dbinom(x = 4, size = 10, prob = 0.4) + dbinom(x = 5, size = 10, prob = 0.4)
```

::: {.cell-output .cell-output-stdout}

```
[1] 0.8337614
```


:::

```{.r .cell-code  code-fold="false"}
# P(3 <= X <= 8)
dbinom(x = 3, size = 10, prob = 0.4) + dbinom(x = 4, size = 10, prob = 0.4) + 
  dbinom(x = 5, size = 10, prob = 0.4) + dbinom(x = 6, size = 10, prob = 0.4) +
  dbinom(x = 7, size = 10, prob = 0.4) + dbinom(x = 8, size = 10, prob = 0.4)
```

::: {.cell-output .cell-output-stdout}

```
[1] 0.8310325
```


:::
:::



</details> -->
</details></section></section><section id="the-hypergeometric-distribution" class="level3"><h3 class="anchored" data-anchor-id="the-hypergeometric-distribution">The Hypergeometric Distribution</h3>
<p>In the example above, we sampled <span class="math inline">\(10\)</span> California residents <em>with</em> replacement from a database of voters. Usually we always sample <em>without</em> replacement, so in a situation such as in the example, where we are define a random variable <span class="math inline">\(X\)</span> to be the number of successes in a <em>simple random sample</em> of <span class="math inline">\(n\)</span> draws from a population of size <span class="math inline">\(N\)</span>, then <span class="math inline">\(X\)</span> will have the <em>hypergeometric</em> distribution with parameters <span class="math inline">\(\left(N, G, n\right)\)</span> where <span class="math inline">\(G\)</span> is the total number of successes in our population. We write this as <span class="math inline">\(X \sim HG(N, G, n)\)</span>. If we let <span class="math inline">\(X\)</span> be the number of successes in <span class="math inline">\(n\)</span> draws, then we have that <span class="math display">\[ P(X = k) = \frac{\binom{G}{k} \times \binom{N-G}{n-k}}{\binom{N}{n}} \]</span> where <span class="math inline">\(N\)</span> is the size of the population, <span class="math inline">\(G\)</span> is the total number of successes in the population, and <span class="math inline">\(n\)</span> is the sample size (so <span class="math inline">\(k\)</span> can take the values <span class="math inline">\(0, 1, \ldots, n\)</span> or <span class="math inline">\(0, 1, \ldots, G\)</span>, if the number of successes in the population is smaller than the sample size.)</p>
<section id="example-gender-discrimination-at-a-large-supermarket" class="level4"><h4 class="anchored" data-anchor-id="example-gender-discrimination-at-a-large-supermarket">Example: Gender discrimination at a large supermarket?</h4>
<p>A large supermarket chain in Florida (with 1,000 employees) occasionally selects employees to receive management training. A group of women there claimed that female employees were passed over for this training in favor of their male colleagues. The company denied this claim. (A similar complaint of gender bias was made about promotions and pay for the 1.6 million women who work or who have worked for Wal-Mart. The Supreme Court heard the case in 2011 and ruled in favor of Wal-Mart, in that it rejected the effort to sue Wal-Mart.)<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> If we set this up as a probability problem, we might ask the question of how many women have been selected for executive training in the last 10 years. In order to do the math, we can simplify the problem. Suppose <em>no</em> women had ever been selected in 10 years of annually selecting one employee for training. Further, suppose that the number of men and women were equal, and suppose the company claims that it draws employees at random for the training, from the 1,000 eligible employees. If <span class="math inline">\(X\)</span> is the number of women that have been picked for training in the past 10 years, what is <span class="math inline">\(P(X = 0)\)</span>?</p>
<p>Note that we are picking a sample of size 10 <em>without</em> replacment and counting the number of <em>women</em> in our sample and therefore, a “success” will be selecting a woman. Modeling <span class="math inline">\(X\)</span> as a hypergeometric random variable, we have that <span class="math inline">\(N = 1,000\)</span>, there are 1,000 employees, and since half are women, we have <span class="math inline">\(G = N-G = 500\)</span>. We want to compute the probability that out of the <span class="math inline">\(10\)</span> employees that were selected at random from the <span class="math inline">\(1,000\)</span> employees, none are women. This gives us, using the formula above:</p>
<p><span class="math display">\[P(X = 0) = \frac{\binom{500}{0} \times \binom{500}{10}}{\binom{1000}{10}} \approx 0.0009\]</span> We will see later how to compute this probability in R.</p>
<!--The function that we can use in `R` to compute hypergeometric probabilities is called `dhyper(x, m, n, k)`, where `x` is the number of successes in the sample that we are counting (what we call $k$), `m` is $G$ or the number of successes in the population, and $n$ is $N-G$. $k$ is the sample size.


::: {.cell}

```{.r .cell-code  code-fold="false"}
dhyper(0, 500, 500, 10)
```

::: {.cell-output .cell-output-stdout}

```
[1] 0.0009331878
```


:::
:::


Note that the function used in `R` to compute the binomial coefficient $\binom{n}{k}$ is `choose(n,k)`.


::: {.cell}

```{.r .cell-code  code-fold="false"}
choose(500, 0)*choose(500, 10)/choose(1000, 10)
```

::: {.cell-output .cell-output-stdout}

```
[1] 0.0009331878
```


:::
:::

-->
</section></section><section id="the-poisson-distribution" class="level3"><h3 class="anchored" data-anchor-id="the-poisson-distribution">The Poisson Distribution</h3>
<p>There are three very important distributions that we see over and over again in many situations. One of them is the <em>binomial</em> distribution, which we have discussed above. The reason this distribution is so ubiquitous is that we use it for <em>classifying</em> things into binary outcomes and <em>counting</em> the number of “successes”. The second important discrete distribution is used to model many different things - from the number of people arriving at an ATM in a given period of time, to the frequency with which officers in the Prussian army were accidentally kicked to death by their horses<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>. This distribution is called the <em>Poisson</em> distribution after a French mathematician, Siméon-Denis Poisson, who developed the theory in the nineteenth century.Interestingly, he was not the <em>first</em> French mathematician to develop this theory. That honor belonged to the seventeenth century mathematician who was a contemporary (and friend) of Isaac Newton, Abraham de Moivre.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> (The third important distribution is called the Normal distribution, also first discovered by de Moivre, which we will introduce later in the course.)</p>
<p>The Poisson distribution appears in situations when we have a very large number of trials in which we are checking the occurrence or not of a particular event which has a very low probability. That is, we have a very large number <span class="math inline">\(n\)</span> of Bernoulli trials, which have a very small <span class="math inline">\(p\)</span> or probability of success, such that the product <span class="math inline">\(np\)</span> is not too small or large. We call the number of successes <span class="math inline">\(X\)</span>, and it counts the occurrence of events whose counts tend to be small. Note that <span class="math inline">\(X \sim Bin(n, p)\)</span>, and <span class="math display">\[P(X = 0) = \binom{n}{0}\times p^0\times (1-p)^n = (1-p)^n.\]</span> For large <span class="math inline">\(n\)</span>, it turns out that <span class="math inline">\((1-p)^n \approx e^{-\lambda}\)</span>, where <span class="math inline">\(\lambda = np\)</span>. We won’t derive the distribution here, but we will use the Poisson distribution for random variables that count the number of occurrences of events in a given period of time in when the events result from a very large number of independent trials. The independence of the trials means that the probability of success does not change over time.</p>
<div class="def">
<dl>
<dt><strong>Poisson distribution</strong></dt>
<dd>
We say that such a random variable <span class="math inline">\(X\)</span> has the Poisson distribution with parameter <span class="math inline">\(\lambda\)</span>, and write it as <span class="math inline">\(X \sim Poisson(\lambda)\)</span>, if <span class="math display">\[ P(X = k) = e^{-\lambda} \frac{\lambda^k}{k!},\]</span> where <span class="math inline">\(k = 0, 1, 2, \ldots\)</span>. That is, the possible values of <span class="math inline">\(X\)</span> are non-negative integers, and since <span class="math inline">\(k!\)</span> grows much faster than <span class="math inline">\(\lambda^k\)</span>, the probability that <span class="math inline">\(X\)</span> takes large values is very small. The parameter <span class="math inline">\(\lambda\)</span> is called the <em>rate</em> of the distribution, and represents how many “successes” we expect in the given time unit.
</dd>
</dl>
</div>
<section id="example-the-number-of-soldiers-kicked-to-death-by-their-horses-each-year-in-each-corps-in-the-prussian-army" class="level4"><h4 class="anchored" data-anchor-id="example-the-number-of-soldiers-kicked-to-death-by-their-horses-each-year-in-each-corps-in-the-prussian-army">Example: The number of soldiers kicked to death by their horses each year in each corps in the Prussian army</h4>
<p>This example was made famous by Ladislaus Bortkiewicz in 1898 when he discussed how a Poisson distribution fit the data he obtained from 14 corps in the Prussian cavalry over a period of 20 years. Let’s look at the empirical histogram of the data. Note that death by horse-kicks was quite rare with less than 1 death per corps per year, over the 280 observations. Bortkiewicz recorded the number of deaths per corps per year, and the majority of years had no deaths in any of the corps. Here is the empirical histogram of the data.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>This is the shape we want when we look at the distribution of a Poisson random variable, where a very low number of events has a much higher probability than larger numbers, so we have a <em>right</em>-skewed distribution.</p>
</section></section></section><section id="binomial-vs-hypergeometric-distributions" class="level2"><h2 class="anchored" data-anchor-id="binomial-vs-hypergeometric-distributions">Binomial vs Hypergeometric distributions</h2>
<p>Both the binomial and the hypergeometric distributions deal with counting the number of successes in a <em>fixed</em> number of trials with binary outcomes. The difference is that for a binomial random variable, the probability of a success stays the <em>same</em> for each trial, and for a hypergeometric random variable, the probability <em>changes</em> with each trial. If we use a box of tickets to describe these random variables, both distributions can be modeled by sampling from boxes with each ticket marked with <span class="math inline">\(0\)</span> or <span class="math inline">\(1\)</span>, but for the binomial distribution, we sample <span class="math inline">\(n\)</span> times <em>with</em> replacement and count the number of successes by summing the draws; and for the hypergeometric distribution, we sample <span class="math inline">\(n\)</span> times <em>without</em> replacement, and count the number of successes by summing the draws.</p>
<p>Note that when the sample size is small relative to the population size, there is not much difference between the probabilities if we use a binomial distribution vs using a hypergeometric distribution. Let’s look at the gender discrimination example again, and pretend that we are sampling <em>with</em> replacement. Now we can use the binomial distribution to compute the chance of never picking a woman. Let <span class="math inline">\(X\)</span> be defined as before, as the number of women selected in <span class="math inline">\(10\)</span> trials.</p>
<p><span class="math display">\[
P(X = 0) = \binom{10}{0}\times\left(\frac{1}{2}\right)^0\times\left(\frac{1}{2}\right)^{10} = 0.0009765625 \approx 0.00098
\]</span> <!--

::: {.cell}

```{.r .cell-code  code-fold="false"}
# n = 10
# p = 0.5

dbinom(0, 10, 0.5)
```

::: {.cell-output .cell-output-stdout}

```
[1] 0.0009765625
```


:::
:::

--></p>
<p>Recall that the probability using the hypergeometric distribution was <code>0.0009331878</code>. You can see that the values are very close to each other. This is an illustration of the fact that we can use a binomial random variable to approximate a hypergeometric random variable if the sample size <span class="math inline">\(n\)</span> is very small compared to the population size <span class="math inline">\(N\)</span>.</p>
<p>Now we will define another important quantity related to random variables. This quantity called the <em>cumulative distribution function</em> is another way to describe the probability distribution of the random variable.</p>
</section><section id="the-cumulative-distribution-function-fx" class="level2"><h2 class="anchored" data-anchor-id="the-cumulative-distribution-function-fx">The cumulative distribution function <span class="math inline">\(F(x)\)</span>
</h2>
<div class="def">
<dl>
<dt><strong>Cumulative distribution function (cdf) <span class="math inline">\(F(x)\)</span></strong></dt>
<dd>
The cumulative distribution function of a random variable <span class="math inline">\(X\)</span> is defined for <em>every</em> real number, and gives, for each <span class="math inline">\(x\)</span>, the amount of probability or mass that has been <em>accumulated</em> up to (and including) the point <span class="math inline">\(x\)</span>, that is, <span class="math inline">\(F(x) = P(X \le x)\)</span>.
</dd>
</dl>
</div>
<p>We usually abbreviate this function to <strong>cdf</strong>. It is a very important function since it also describes the probability distribution of <span class="math inline">\(X\)</span>. In order to compute <span class="math inline">\(F(x)\)</span> for any real number <span class="math inline">\(x\)</span>, we just add up all the probability so far: <span class="math display">\[
F(x) = \sum_{y \le x} f(y)
\]</span></p>
<p>For example, if <span class="math inline">\(X\)</span> is the number of heads in <span class="math inline">\(3\)</span> tosses of a fair coin, recall that:</p>
<p><span class="math display">\[ f(x) = \begin{cases}
  \displaystyle \frac{1}{8}, \; x = 0, 3 \\
  \displaystyle \frac{3}{8}, \; x = 1, 2
  \end{cases} \]</span></p>
<p>In this case, <span class="math inline">\(F(x) = P(X\le x) = 0\)</span> for all <span class="math inline">\(x &lt; 0\)</span> since the first positive probability is at <span class="math inline">\(0\)</span>. Then, <span class="math inline">\(F(0) = P(X \le 0) = 1/8\)</span> after which it stays at <span class="math inline">\(1/8\)</span> until <span class="math inline">\(x = 1\)</span>. Look at the graph below:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/cdf.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="700"></p>
</figure>
</div>
<p>Notice that <span class="math inline">\(F(x)\)</span> is a step function, and right continuous. The jumps are at exactly the values for which <span class="math inline">\(f(x) &gt; 0\)</span>. We can get <span class="math inline">\(F(x)\)</span> from <span class="math inline">\(f(x)\)</span> by adding the values of <span class="math inline">\(f\)</span> up to and including <span class="math inline">\(x\)</span>, and we can get <span class="math inline">\(f(x)\)</span> from <span class="math inline">\(F(x)\)</span> by looking at the size of the jumps.</p>
<section id="example-writing-down-the-cdf-of-a-bernoulli-random-variable" class="level4"><h4 class="anchored" data-anchor-id="example-writing-down-the-cdf-of-a-bernoulli-random-variable">Example: Writing down the cdf of a Bernoulli random variable</h4>
<p>Suppose $X $ Bernoulli<span class="math inline">\((0.5)\)</span>. Then we know that <span class="math inline">\(P(X = 0) = P(X=1) = 0.5\)</span>. The cdf of <span class="math inline">\(X\)</span>, <span class="math inline">\(F(x)\)</span> gives us the total probability so far up to and including <span class="math inline">\(x\)</span>. For example, if <span class="math inline">\(x = -3\)</span>, <span class="math inline">\(F(x) =0\)</span> since the first time there is any positive probability for <span class="math inline">\(X\)</span> is at <span class="math inline">\(0\)</span>. At <span class="math inline">\(x = 0\)</span>, <span class="math inline">\(F(x) = 0.5\)</span>, and it stays there until it gets to <span class="math inline">\(x =1\)</span>, when it “accumulates” another <span class="math inline">\(0.5\)</span> of probability. Here is the figure:</p>
<p><img src="images/cdf-bernoulli.png" class="img-fluid quarto-figure quarto-figure-center" width="700"> Notice where the function is open and closed (<span class="math inline">\(\circ\)</span> vs <span class="math inline">\(\bullet\)</span>).</p>
</section><section id="exercise-drawing-the-graph-of-the-cdf" class="level4"><h4 class="anchored" data-anchor-id="exercise-drawing-the-graph-of-the-cdf">Exercise: Drawing the graph of the cdf</h4>
<p>Let <span class="math inline">\(X\)</span> be the random variable defined by the distribution table below. Find the cdf of <span class="math inline">\(X\)</span>, and draw the graph, making sure to define <span class="math inline">\(F(x)\)</span> for all real numbers <span class="math inline">\(x\)</span>. Before you do that, you will have to determine the value of <span class="math inline">\(f(x)\)</span> for <span class="math inline">\(x = 4\)</span>.</p>
<center>
<table class="table">
<thead><tr class="header">
<th style="text-align: center;"><span class="math inline">\(x\)</span></th>
<th style="text-align: center;"><span class="math inline">\(P(X = x)\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0.2\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0.3\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0.4\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(4\)</span></td>
<td style="text-align: center;">??</td>
</tr>
</tbody>
</table>
</center>
<details><summary>
Check your answer
</summary><p>Since <span class="math inline">\(\displaystyle \sum_x P(X = x) = \sum_x f(x) = 1\)</span>, <span class="math inline">\(f(4) = 1-(0.2+0.3+0.4) = 0.1.\)</span> Therefore <span class="math inline">\(F(x)\)</span> is as shown below.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/cdf-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="700"></p>
</figure>
</div>
</details></section></section><section id="ideas-in-code" class="level2"><h2 class="anchored" data-anchor-id="ideas-in-code">Ideas in code</h2>
<section id="useful-functions" class="level3"><h3 class="anchored" data-anchor-id="useful-functions">Useful functions</h3>
<section id="factorial-and-choose" class="level4"><h4 class="anchored" data-anchor-id="factorial-and-choose">
<code>factorial()</code> and <code>choose()</code>
</h4>
<p>The function used to compute the binomial coefficient <span class="math inline">\(\binom{n}{k}\)</span> is <code>choose(n,k)</code>, while the function to compute <span class="math inline">\(n!\)</span> is <code>factorial(n)</code>. Here are a couple of examples:</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">" 5! is equal to "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span> <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 5! is equal to  120</code></pre>
</div>
</div>
<p><code><a href="https://rdrr.io/r/base/cat.html">cat()</a></code> prints whatever is in the <code>()</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Special.html">choose</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
</div>
<p>While these are both functions that are useful if we want to compute binomial probabilities, we won’t use them since R has built in functions that calculate both <span class="math inline">\(f(x)\)</span> and <span class="math inline">\(F(x)\)</span> for many distributions, including the ones that we have listed in these notes.</p>
<p>All these all have the similar forms, and we will list the functions and their arguments here. For each distribution, there are four types of functions and they begin with <code>d</code>, <code>p</code>, <code>r</code>, and <code>q</code>, followed by an abbreviation of the name of the distribution. We will describe the first three types of functions in these notes.</p>
</section></section><section id="bernoullip-and-binomialnp" class="level3"><h3 class="anchored" data-anchor-id="bernoullip-and-binomialnp">Bernoulli<span class="math inline">\((p)\)</span> and Binomial<span class="math inline">\((n,p)\)</span>
</h3>
<ol type="1">
<li>
<code>dbinom</code> computes the pmf of <span class="math inline">\(X\)</span>, <span class="math inline">\(f(k) = P(X = k)\)</span>, for <span class="math inline">\(k = 0, 1, \ldots, n\)</span>.</li>
</ol>
<ul>
<li>Arguments:
<ul>
<li>
<code>x</code>: the value of <span class="math inline">\(k\)</span> in <span class="math inline">\(f(k)\)</span>
</li>
<li>
<code>size</code>: the parameter <span class="math inline">\(n\)</span>, the number of trials</li>
<li>
<code>prob</code>: the parameter <span class="math inline">\(p\)</span>, the probability of success</li>
</ul>
</li>
</ul>
<ol start="2" type="1">
<li>
<code>pbinom</code> computes the cdf <span class="math inline">\(F(x) = P(X \le x)\)</span><br>
</li>
</ol>
<ul>
<li>Arguments:
<ul>
<li>
<code>q</code>: the value of <span class="math inline">\(x\)</span> in <span class="math inline">\(F(x)\)</span>
</li>
<li>
<code>size</code>: the parameter <span class="math inline">\(n\)</span>, the number of trials</li>
<li>
<code>prob</code>: the parameter <span class="math inline">\(p\)</span>, the probability of success</li>
</ul>
</li>
</ul>
<ol start="3" type="1">
<li>
<code>rbinom</code> generates a sample (random numbers) from the Binomial<span class="math inline">\((n,p)\)</span> distribution.</li>
</ol>
<ul>
<li>Arguments:
<ul>
<li>
<code>n</code>: the sample size</li>
<li>
<code>size</code>: the parameter <span class="math inline">\(n\)</span>, the number of trials</li>
<li>
<code>prob</code>: the parameter <span class="math inline">\(p\)</span>, the probability of success</li>
</ul>
</li>
</ul>
<section id="example" class="level4"><h4 class="anchored" data-anchor-id="example">Example</h4>
<p>Suppose we consider <span class="math inline">\(n = 3\)</span>, <span class="math inline">\(p= 0.5\)</span>, that is, <span class="math inline">\(X\)</span> is the number of successes in 3 independent Bernoulli trials.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># probability that we see exactly 1 success = f(1)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">3</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.375</code></pre>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># probability that we see at most 1 success = F(1) = f(0) + f(1)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span>q <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">3</span>, prob <span class="op">=</span> <span class="fl">0.5</span> <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5</code></pre>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># check f(0) + f(1)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, size <span class="op">=</span> <span class="fl">3</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">3</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5</code></pre>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># generate a sample of size 5 where each element in sample </span></span>
<span><span class="co"># represents number of successes in 3 trials (like number of heads in 3 tosses)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span>, size <span class="op">=</span> <span class="fl">3</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 1 2 1 2</code></pre>
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># if we want to generate a sequence of 10 tosses of a fair coin, for example:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0 1 1 0 1 1 0 1 0 0</code></pre>
</div>
</div>
</section><section id="exercise" class="level4"><h4 class="anchored" data-anchor-id="exercise">Exercise</h4>
<p>In the section on the Binomial distribution above, we had an exercise where <span class="math inline">\(X \sim Bin(10, 0.4)\)</span>. Using the functions defined above, compute:</p>
<ul>
<li><span class="math inline">\(X = 5\)</span></li>
<li><span class="math inline">\(X \le 5\)</span></li>
<li><span class="math inline">\(3 \le X \le 8\)</span></li>
</ul>
<details><summary>
Check your answer
</summary><div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># P(X = 5)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">5</span>, size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2006581</code></pre>
</div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># P(X = 5)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">0.4</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">10</span>, <span class="fl">0.4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2006581</code></pre>
</div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># P(X &lt;= 5)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">2</span>, size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3</span>, size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">4</span>, size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">5</span>, size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8337614</code></pre>
</div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># P(X &lt;= 5)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">0.4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8337614</code></pre>
</div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># P(3 &lt;= X &lt;= 8)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3</span>, size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">4</span>, size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">5</span>, size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">6</span>, size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">7</span>, size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">8</span>, size <span class="op">=</span> <span class="fl">10</span>, prob <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8310325</code></pre>
</div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># P(3 &lt;= X &lt;= 8)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">10</span>, <span class="fl">0.4</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">10</span>, <span class="fl">0.4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8310325</code></pre>
</div>
</div>
</details><p>What is going on in the last expression? Why is <span class="math inline">\(P(3 &lt;= X &lt;= 8) = F(8) - F(2)\)</span>?</p>
<details><summary>
Check your answer
</summary><p><span class="math inline">\(P(3 &lt;= X &lt;= 8)\)</span> consists of all the probability at the points <span class="math inline">\(3, 4, 5, 6, 7, 8\)</span>.</p>
<p><span class="math inline">\(F(8) = P(X \le 8)\)</span> is all the probability up to <span class="math inline">\(8\)</span>, including any probability at <span class="math inline">\(8\)</span>. We subtract off all the probability up to and including <span class="math inline">\(2\)</span> from <span class="math inline">\(F(8)\)</span> and are left with the probability at the values <span class="math inline">\(3\)</span> up to and including <span class="math inline">\(8\)</span>, which is what we want.</p>
</details></section></section><section id="hypergeometric-n-g-n" class="level3"><h3 class="anchored" data-anchor-id="hypergeometric-n-g-n">Hypergeometric <span class="math inline">\((N, G, n)\)</span>
</h3>
<p>The notation is a bit confusing, but just remember that <code>x</code> is usually the number <span class="math inline">\(k\)</span> that you want the probability for, and <code>m + n</code><span class="math inline">\(=N\)</span> is the total number of successes and failures, or the population size.</p>
<ol type="1">
<li>
<code>dhyper</code> computes the pmf of <span class="math inline">\(X\)</span>, <span class="math inline">\(f(k) = P(X = k)\)</span>, for <span class="math inline">\(k = 0, 1, \ldots, n\)</span>.</li>
</ol>
<ul>
<li>Arguments:
<ul>
<li>
<code>x</code>: the value of <span class="math inline">\(k\)</span> in <span class="math inline">\(f(k)\)</span>
</li>
<li>
<code>m</code>: the parameter <span class="math inline">\(G\)</span>, the number of successes in the population</li>
<li>
<code>n</code>: the value <span class="math inline">\(N-G\)</span>, the number of failures in the population</li>
<li>
<code>k</code>: the sample size (number of draws <span class="math inline">\(n\)</span>, note that <span class="math inline">\(0 \le k \le m+n\)</span>)</li>
</ul>
</li>
</ul>
<ol start="2" type="1">
<li>
<code>phyper</code> computes the cdf <span class="math inline">\(F(x) = P(X \le x)\)</span><br>
</li>
</ol>
<ul>
<li>Arguments:
<ul>
<li>
<code>q</code>: the value of <span class="math inline">\(x\)</span> in <span class="math inline">\(F(x)\)</span>
</li>
<li>
<code>m</code>: the parameter <span class="math inline">\(G\)</span>, the number of successes in the population</li>
<li>
<code>n</code>: the value <span class="math inline">\(N-G\)</span>, the number of failures in the population</li>
<li>
<code>k</code>: the sample size (number of draws <span class="math inline">\(n\)</span>)</li>
</ul>
</li>
</ul>
<ol start="3" type="1">
<li>
<code>rhyper</code> generates a sample (random numbers) from the hypergeometric<span class="math inline">\((N, G, n)\)</span> distribution.</li>
</ol>
<ul>
<li>Arguments:
<ul>
<li>
<code>nn</code>: the number of random numbers desired</li>
<li>
<code>m</code>: the parameter <span class="math inline">\(G\)</span>, the number of successes in the population</li>
<li>
<code>n</code>: the value <span class="math inline">\(N-G\)</span>, the number of failures in the population</li>
<li>
<code>k</code>: the sample size (number of draws <span class="math inline">\(n\)</span>)</li>
</ul>
</li>
</ul>
<section id="example-1" class="level4"><h4 class="anchored" data-anchor-id="example-1">Example</h4>
<p>Suppose we consider <span class="math inline">\(N = 10, G  = 6, n = 3\)</span>, that is, <span class="math inline">\(X\)</span> is the number of successes in 3 draws without replacement from a box that has 6 tickets marked <span class="math inline">\(\fbox{1}\)</span> and 4 tickets marked <span class="math inline">\(\fbox{0}\)</span></p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># probability that we see exactly 1 success = f(1)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Hypergeometric.html">dhyper</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">6</span>, n <span class="op">=</span> <span class="fl">4</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3</code></pre>
</div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># you can compute this by hand as well to check. </span></span>
<span></span>
<span><span class="co"># probability that we see at most 1 success = F(1) = f(0) + f(1)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Hypergeometric.html">phyper</a></span><span class="op">(</span>q <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">6</span>, n <span class="op">=</span> <span class="fl">4</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3333333</code></pre>
</div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># check f(0) + f(1)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Hypergeometric.html">dhyper</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, m <span class="op">=</span> <span class="fl">6</span>, n <span class="op">=</span> <span class="fl">4</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Hypergeometric.html">dhyper</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">6</span>, n <span class="op">=</span> <span class="fl">4</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3333333</code></pre>
</div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># generate a sample of size 5 where each element in sample </span></span>
<span><span class="co"># represents number of successes in 3 draws</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Hypergeometric.html">rhyper</a></span><span class="op">(</span>nn <span class="op">=</span> <span class="fl">5</span>, m <span class="op">=</span> <span class="fl">6</span>, n <span class="op">=</span> <span class="fl">4</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 3 2 1 2</code></pre>
</div>
</div>
</section></section><section id="poissonlambda" class="level3"><h3 class="anchored" data-anchor-id="poissonlambda">Poisson(<span class="math inline">\(\lambda\)</span>)</h3>
<ol type="1">
<li>
<code>dpois</code> computes the pmf of <span class="math inline">\(X\)</span>, <span class="math inline">\(f(k) = P(X = k)\)</span>, for <span class="math inline">\(k = 0, 1, 2,  \ldots\)</span>.</li>
</ol>
<ul>
<li>Arguments:
<ul>
<li>
<code>x</code>: the value of <span class="math inline">\(k\)</span> in <span class="math inline">\(f(k)\)</span>
</li>
<li>
<code>lambda</code>: the parameter <span class="math inline">\(\lambda\)</span>
</li>
</ul>
</li>
</ul>
<ol start="2" type="1">
<li>
<code>ppois</code> computes the cdf <span class="math inline">\(F(x) = P(X \le x)\)</span><br>
</li>
</ol>
<ul>
<li>Arguments:
<ul>
<li>
<code>q</code>: the value of <span class="math inline">\(x\)</span> in <span class="math inline">\(F(x)\)</span>
</li>
<li>
<code>lambda</code>: the parameter <span class="math inline">\(\lambda\)</span>
</li>
</ul>
</li>
</ul>
<ol start="3" type="1">
<li>
<code>rpois</code> generates a sample (random numbers) from the Poisson(<span class="math inline">\(\lambda\)</span>) distribution.</li>
</ol>
<ul>
<li>Arguments:
<ul>
<li>
<code>n</code>: the desired sample size</li>
<li>
<code>lambda</code>: the parameter <span class="math inline">\(\lambda\)</span>
</li>
</ul>
</li>
</ul>
<section id="example-2" class="level4"><h4 class="anchored" data-anchor-id="example-2">Example</h4>
<p>Suppose we consider <span class="math inline">\(\lambda = 1\)</span>, that is <span class="math inline">\(X \sim\)</span> Poisson<span class="math inline">\((\lambda)\)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># probability that we see exactly 1 event = f(1)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, lambda <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3678794</code></pre>
</div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#check f(1) = exp(-lambda)*lambda = exp(-1)*1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3678794</code></pre>
</div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># probability that we see at most 1 success = F(1) = f(0) + f(1)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">ppois</a></span><span class="op">(</span>q <span class="op">=</span> <span class="fl">1</span>,lambda <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7357589</code></pre>
</div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># check f(0) + f(1)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, lambda <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, lambda <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7357589</code></pre>
</div>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># generate a sample of size 5 where each element in sample </span></span>
<span><span class="co"># represents a random count from the Poisson(1) distribution</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span>, lambda <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 1 1 0 2</code></pre>
</div>
</div>
<!--## Connections between discrete random variables and draws from a box of tickets

#### Example: the discrete uniform random variable

Say we have a ten sided die. How can we set up a simulation to model for rolling this die once? (We can simulate it using a box of tickets, or in R).

<details><summary> Check your answer </summary>

A box with ten tickets, marked $\fbox{1}, \fbox{2}, \ldots \fbox{10}$; and draw once from this box. 

We can also simulate the probability distribution by drawing over and over again, and looking at the empirical distribution. You can see below that it closely matches the actual probability distribution.

:::{.content-visible when-format="html"}

::: {.cell}

```{.r .cell-code}
die_10 <- seq(from = 1, to = 10, by = 1)
prob_10 <- rep(0.1, 10)

set.seed(12345)

n_rolls <- 10^5

rolls <- sample(die_10, n_rolls, replace = TRUE)

p1 <- data.frame(die_10) |> 
  mutate(prob_10 = prob_10) |>
  ggplot(aes(x = factor(die_10), y = prob_10)) +
  geom_col(fill = "goldenrod2", width = 0.98) + 
   ylab("probability") + 
   xlab(" number of spots") + 
  ggtitle("Outcomes from rolling a ten sided die:\n probability distribution")
  

p2 <- data.frame(rolls) |> 
  ggplot(aes(x=factor(rolls))) + 
  geom_bar(aes(y = after_stat(count)/sum(after_stat(count))), fill="blue", width = 0.98) + 
  ylab("proportion of draws") + 
  xlab("ticket drawn") + 
  ggtitle("Outcomes from rolling a ten sided die:\n empirical distribution") 
 

p1 + p2
```

::: {.cell-output-display}
![](notes_files/figure-html/unnamed-chunk-15-1.png){width=960}
:::
:::

:::

:::{.content-visible when-format="pdf"}

::: {.cell}
::: {.cell-output-display}
![](notes_files/figure-html/unnamed-chunk-16-1.png){width=960}
:::
:::

:::

#### Example: the binomial(*n*, *p*) random variable

Let $X \sim Bin(30, 0.5)$. We can simulate the values of this random variable by drawing from the box ![](images/binom-box.jpeg){width="80"} $30$ times, and summing the draws. This will simulate counting the number of successes in $n$ trials. As in the example above, we will plot the probability distribution of $X$ on the left, and the empirical distribution on the right. 

:::{.content-visible when-format="html"}


::: {.cell}

```{.r .cell-code}
box <- c(0,1)
binom_30 <- seq(from = 0, to = 30, by = 1)
prob_30 <- round(dbinom(binom_30, size = 30, prob = 0.5), 3)

set.seed(12345)

n_sims <- 10^4

draws <- replicate(n_sims, sum(sample(box, 30, replace = TRUE)))

p1 <- data.frame(binom_30) |> 
  mutate(prob_30 = prob_30) |>
  ggplot(aes(x = factor(binom_30), y = prob_30)) +
  geom_col(fill = "goldenrod2", width = 0.98, color = "white") + 
   ylab("probability") + 
   xlab(" number of successes") + 
  ggtitle("Probabilities for the binomial random variable \n n = 30, p = 0.5") +
  theme_bw()
  

fac_30 <- factor(binom_30, levels = 0:30)

p2 <- data.frame(draws) |> 
  ggplot(aes(x=draws)) + 
  geom_bar(aes(y=..prop..), fill="blue", width = 0.98, color = "white") + 
  ylab("proportion of draws") + 
  xlab("sum of draws") + 
  ggtitle("Empirical distribution for random numbers generated \n
          from the Bin(30, 0.5) distribution")  +
  theme_bw() +
  scale_x_discrete(limits = factor(seq(0,30)), labels = fac_30, drop = FALSE)
  

p1 + p2
```

::: {.cell-output-display}
![](notes_files/figure-html/unnamed-chunk-17-1.png){width=960}
:::
:::

:::

:::{.content-visible when-format="pdf"}

::: {.cell}
::: {.cell-output-display}
![](notes_files/figure-html/unnamed-chunk-18-1.png){width=960}
:::
:::

:::
[^covid]: <https://www.covidstates.org/reports/state-of-the-covid-19-pandemic>
-->
</section></section></section><section id="summary" class="level2"><h2 class="anchored" data-anchor-id="summary">Summary</h2>
<ul>
<li>In these notes, we defined random variables, and described discrete and continuous random variables.</li>
<li>For any random variable, there is an associated probability distribution, and this is described by the probability mass function or pmf <span class="math inline">\(f(x)\)</span>.</li>
<li>We also defined a function that, for a random variable <span class="math inline">\(X\)</span>, and any real number <span class="math inline">\(x\)</span>, describes all the probability that is to the left of <span class="math inline">\(x\)</span>. This function is called the cumulative distribution function (cdf) of <span class="math inline">\(X\)</span> and is denoted <span class="math inline">\(F(x)\)</span>.</li>
<li>We looked at some special distributions (discrete uniform, Bernoulli, binomial, hypergeometric, and Poisson)</li>
<li>We defined functions in R that can compute the pmf and cdf for the named distributions (except for discrete uniform since it doesn’t need a special function as we can just use <code><a href="https://rdrr.io/r/base/sample.html">sample()</a></code>). <!--- Finally, we looked at connections between random variables and boxes with tickets, and saw how to simulate some empirical distributions.-->
</li>
</ul>


</section><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>
<ol>
<li id="fn1"><p><a href="https://en.wikipedia.org/wiki/Binomial_coefficient" class="uri">https://en.wikipedia.org/wiki/Binomial_coefficient</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p><a href="https://dornsife.usc.edu/news-briefs/wp-content/uploads/sites/182/2024/01/USC-CSU-CEPPoll.pdf" class="uri">https://dornsife.usc.edu/news-briefs/wp-content/uploads/sites/182/2024/01/USC-CSU-CEPPoll.pdf</a><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p><a href="https://www.latimes.com/world/la-xpm-2011-jun-20-la-naw-wal-mart-court-20110621-story.html" class="uri">https://www.latimes.com/world/la-xpm-2011-jun-20-la-naw-wal-mart-court-20110621-story.html</a><a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p><a href="https://en.wikipedia.org/wiki/Poisson_distribution" class="uri">https://en.wikipedia.org/wiki/Poisson_distribution</a><a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p><a href="https://en.wikipedia.org/wiki/Poisson_distribution" class="uri">https://en.wikipedia.org/wiki/Poisson_distribution</a><a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
    <a class="nav-link" href="../../license.html">
<p>License</p>
</a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>