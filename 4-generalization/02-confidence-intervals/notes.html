<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Stat 20 - Confidence Intervals</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../4-generalization/03-bootstrapping/notes.html" rel="next">
<link href="../../4-generalization/01-sampling-distributions/notes.html" rel="prev">
<link href="../../assets/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<meta property="og:title" content="Stat 20 - Confidence Intervals">
<meta property="og:description" content="Quantifying the sampling variability of a statistic.">
<meta property="og:image" content="https://www.stat20.org/4-generalization/02-confidence-intervals/assets/stat20-hex.png">
<meta property="og:site_name" content="Stat 20">
<meta name="twitter:title" content="Stat 20 - Confidence Intervals">
<meta name="twitter:description" content="Quantifying the sampling variability of a statistic.">
<meta name="twitter:image" content="https://www.stat20.org/4-generalization/02-confidence-intervals/assets/stat20-hex.png">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-sm " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../assets/stat20-hex-small.png" alt="Stat 20 logo" class="navbar-logo"></a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../../syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../office-hours.html"> 
<span class="menu-text">Office Hours</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../notes.html" aria-current="page"> 
<span class="menu-text">Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../assignments.html"> 
<span class="menu-text">Assignments</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools tools-wide">
    <a href="https://edstem.org/us/courses/51198" title="" class="quarto-navigation-tool px-1" aria-label="Ed Discussion Forum"><i class="bi bi-chat-fill"></i></a>
    <a href="https://www.gradescope.com/courses/693050" title="" class="quarto-navigation-tool px-1" aria-label="Gradescope"><i class="bi bi-bar-chart-fill"></i></a>
    <a href="https://stat20.datahub.berkeley.edu/" title="" class="quarto-navigation-tool px-1" aria-label="RStudio"><i class="bi bi-r-circle-fill"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../4-generalization/02-confidence-intervals/notes.html">Confidence Intervals</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../1-questions-and-data/01-understanding-the-world/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Understanding the World with Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../1-questions-and-data/02-taxonomy-of-data/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Taxonomy of Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../2-summarizing-data/01-summarizing-categorical-data/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summarizing Categorical Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../2-summarizing-data/02-summarizing-numerical-data/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summarizing Numerical Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../2-summarizing-data/04-conditioning/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Pipelines</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../2-summarizing-data/03-a-grammar-of-graphics/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Grammar of Graphics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../2-summarizing-data/06-summarizing-associations/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summarizing Numerical Associations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../2-summarizing-data/07-multiple-linear-regression/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Linear Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../3-probability/01-chance-intro/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introducing Probability</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../3-probability/02-cond-prob-indep/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Computing Probabilities</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../3-probability/03-probability-dsns/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probability Distributions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../3-probability/04-random-variables/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Random Variables</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../3-probability/05-ev-se/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Expected value and variance of a random variable</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../3-probability/06-normal-approx/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Continuous Distributions and Normal Approximations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../4-generalization/01-sampling-distributions/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">From Samples to Populations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../4-generalization/02-confidence-intervals/notes.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Confidence Intervals</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../4-generalization/03-bootstrapping/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bootstrapping</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../4-generalization/04-hypothesis-tests/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hypothesis Testing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../4-generalization/05-hypothesis-tests-2/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hypothesis Tests II</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../4-generalization/06-wrong-by-design/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Wrong by Design</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../6-prediction/01-method-of-least-squares/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Method of Least Squares</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../6-prediction/02-improving-predictions/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Evaluating and Improving Predictions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../6-prediction/03-overfitting/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overfitting</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../6-prediction/05-logistic-regression/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Logistic Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../5-causation/01-defining-causality/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Defining Causality</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../5-causation/02-experiments/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Randomized Experiments</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../5-causation/03-matching/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Causal Effects in Observational Studies</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../5-causation/04-time/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using Time to Measure Causal Effects</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#a-simple-random-sample" id="toc-a-simple-random-sample" class="nav-link active" data-scroll-target="#a-simple-random-sample">A Simple Random Sample</a>
  <ul>
<li><a href="#the-population-distribution" id="toc-the-population-distribution" class="nav-link" data-scroll-target="#the-population-distribution">The Population Distribution</a></li>
  <li><a href="#the-empirical-distribution" id="toc-the-empirical-distribution" class="nav-link" data-scroll-target="#the-empirical-distribution">The Empirical Distribution</a></li>
  <li><a href="#the-sampling-distribution" id="toc-the-sampling-distribution" class="nav-link" data-scroll-target="#the-sampling-distribution">The Sampling Distribution</a></li>
  <li><a href="#putting-the-three-panels-together" id="toc-putting-the-three-panels-together" class="nav-link" data-scroll-target="#putting-the-three-panels-together">Putting the Three Panels Together</a></li>
  </ul>
</li>
  <li>
<a href="#inference-for-a-population-average" id="toc-inference-for-a-population-average" class="nav-link" data-scroll-target="#inference-for-a-population-average">Inference for a Population Average</a>
  <ul>
<li><a href="#standard-error" id="toc-standard-error" class="nav-link" data-scroll-target="#standard-error">Standard Error</a></li>
  <li>
<a href="#confidence-intervals" id="toc-confidence-intervals" class="nav-link" data-scroll-target="#confidence-intervals">Confidence Intervals</a>
  <ul class="collapse">
<li><a href="#normal-confidence-intervals" id="toc-normal-confidence-intervals" class="nav-link" data-scroll-target="#normal-confidence-intervals">Normal Confidence Intervals</a></li>
  </ul>
</li>
  </ul>
</li>
  <li><a href="#inference-for-a-population-proportion" id="toc-inference-for-a-population-proportion" class="nav-link" data-scroll-target="#inference-for-a-population-proportion">Inference for a Population Proportion</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="notes.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Confidence Intervals</h1>
<p class="subtitle lead">Quantifying the sampling variability of a statistic.</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p><span class="dropcap">T</span>he process of generalizing from a statistic of a sample to a parameter of a population is known as <em>statistical inference</em>. The parameter of interest could be a mean, median, proportion, correlation coefficient, the coefficient of a linear model . . . the list goes on. In the scenario that unfolded in Pimentel Hall, the parameter was the mean year of the 527 students in the class. The process of estimating that parameter by calculating the sample mean of the 18 students who decided to sit in the front row that day induces a sampling distribution.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="notes_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>This sampling distribution captures the two sources of error that creep in while generalizing. The horizontal offset from the true population parameter (the red line) to the mean of the sampling distribution (the gold triangle) represents the bias. The spread of the sampling distribution represents the variation. In these lecture notes you’ll learn how to quantify sampling variability using two common tools.</p>
<dl>
<dt><strong>Standard Error (SE)</strong></dt>
<dd>
The standard deviation of the sampling distribution of a statistic.
</dd>
<dt><strong>Confidence Interval</strong></dt>
<dd>
An interval of two values that represent lower and upper bounds on the statistic that captures most of the sampling distribution.
</dd>
</dl>
<p>To focus on the variation, let’s introduce a second example, one in which we will not need to worry about bias.</p>
<section id="a-simple-random-sample" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="a-simple-random-sample">A Simple Random Sample</h2>
<section id="restaurants-in-san-francisco" class="level5"><h5 class="anchored" data-anchor-id="restaurants-in-san-francisco">Restaurants in San Francisco</h5>
<p>Every year, the city of San Francisco’s health department visits all the restaurants in the city and inspects them for food safety. Each restaurant is given an inspection score; these range from 100 (perfectly clean) to 48 (serious potential for contamination). We have these scores from 2016. Let’s build up to the sampling distribution bit by bit.</p>
<p><!-- ADD REF --></p>
</section><section id="the-population-distribution" class="level4 page-columns page-full"><h4 class="anchored" data-anchor-id="the-population-distribution">The Population Distribution</h4>
<p>Our population consists of the restaurants in San Francisco. Since the data are published online for all restaurants, we have a census<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> of scores for every restaurant in the city.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="notes_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<p>The population distribution is skewed left with a long left tail. The highest possible score is 100. It appears that even scores are more popular than odd scores for scores in the 90s; in fact there are no scores of 99, 97, and 95.</p>
<p>We can calculate two parameters of this population:</p>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="">Population parameters, like the parameters of probability distributions, are usually given a Greek letter. The population mean is <span class="math inline">\(\mu\)</span>, said “myoo”, and the population standard deviation is <span class="math inline">\(\sigma\)</span>, said “sigma”.</span></div></div>
<ul>
<li>The <em>population mean</em>, <span class="math inline">\(\mu\)</span>, is 87.6.</li>
<li>The <em>population SD</em>, <span class="math inline">\(\sigma\)</span>, is 8.9.</li>
</ul></section><section id="the-empirical-distribution" class="level4 page-columns page-full"><h4 class="anchored" data-anchor-id="the-empirical-distribution">The Empirical Distribution</h4>
<p>Although we have data on all of the restaurants in the city, imagine that you’re an inspector who has visited a simple random sample of 100 restaurants. That is, you draw 100 times without replacement from the population, with each unit equally likely to be selected. This leads to a representative sample that will have no selection bias.</p>
<p>The distribution of this sample (an empirical distribution) looks like:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="notes_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<p>The sample statistics here are:</p>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="">While parameters are symbolized with Greek letters, statistics are usually symbolized with Latin letters.</span></div></div>
<ul>
<li>The <em>sample mean</em>, <span class="math inline">\(\bar{x}\)</span>, is 86.27.</li>
<li>The <em>sample SD</em>, <span class="math inline">\(s\)</span>, is 9.9.</li>
</ul>
<p>Observe that the empirical distribution resembles the population distribution because we are using a sampling method without with selection bias. It’s not a perfect match but the shape is similar. The sample average (<span class="math inline">\(\bar{x}\)</span>) and the sample SD (<span class="math inline">\(s\)</span>) are also close to but not the same as the population average (<span class="math inline">\(\mu\)</span>) and SD (<span class="math inline">\(\sigma\)</span>).</p>
</section><section id="the-sampling-distribution" class="level4"><h4 class="anchored" data-anchor-id="the-sampling-distribution">The Sampling Distribution</h4>
<p>If you compared your sample to that of another inspector who visited 100 restaurants, their sample would not be identical to yours, but it would still resemble the population distribution, and its <span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(s\)</span> would be close to those of all the restaurants in the city.</p>
<p>The distribution of the possible values of the <span class="math inline">\(\bar{x}\)</span> of a simple random sample of 100 restaurants is the sampling distribution of the mean (of the sample). We can use it to, for example, find the chance that the sample mean will be over 88, or the chance that the sample mean will be between 85 and 95.</p>
<p>Ordinarily this distribution takes some work to create, but in this thought-experiment have have access to the full population, so we can simply use the computer to simulate the process. We repeat 100,000 times the process of drawing a simple random sample of 100 restaurants. The full distribution looks like:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="notes_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<p>We can consider numerical summaries of this distribution:</p>
<ul>
<li>The mean of the sampling distribution is 87.6.</li>
<li>The SD of the sampling distribution, which is called the <em>Standard Error (SE)</em>, is 0.9. This convention of using a different name for the SD for the distribution of a statistic helps keep straight which kind of standard deviation we’re talking about.</li>
</ul>
<p>Observe that the sampling distribution of <span class="math inline">\(\bar{x}\)</span> doesn’t look anything like the population or sample. Instead, it’s roughly symmetric in shape with a center that matches <span class="math inline">\(\mu\)</span>, and a small SE. The small size of the SE reflects the fact that the <span class="math inline">\(\bar{x}\)</span> tends to be quite close to <span class="math inline">\(\mu\)</span>.</p>
<p>Again, the sampling distribution provides the distribution for the possible values of <span class="math inline">\(\bar{x}\)</span>. From this distribution, we find that the chance <span class="math inline">\(\bar{x}\)</span> is over 88 is about 0.33, and the chance <span class="math inline">\(\bar{x}\)</span> is between 85 and 95 is roughly, 1.</p>
</section><section id="putting-the-three-panels-together" class="level4"><h4 class="anchored" data-anchor-id="putting-the-three-panels-together">Putting the Three Panels Together</h4>
<p>Let’s look at these three aspects of this process side-by-side.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
<table class="table">
<thead><tr class="header">
<th></th>
<th>Population</th>
<th>Empirical</th>
<th>Sampling</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Shape</td>
<td>left skew</td>
<td>left skew</td>
<td>bell-shaped / normal</td>
</tr>
<tr class="even">
<td>Mean</td>
<td>
<span class="math inline">\(\mu\)</span> = 87.6</td>
<td>
<span class="math inline">\(\bar{x}\)</span> = 86.27</td>
<td>87.6</td>
</tr>
<tr class="odd">
<td>SD</td>
<td>
<span class="math inline">\(\sigma\)</span> = 8.9</td>
<td>
<span class="math inline">\(s\)</span> = 9.9</td>
<td>0.89</td>
</tr>
</tbody>
</table>
<p>Observe that:</p>
<ol type="1">
<li><p><span class="math inline">\(\mu\)</span> and the mean of the sampling distribution are roughly the same.</p></li>
<li>
<p><span class="math inline">\(\sigma\)</span> and the SE of the sample averages are related in the following way<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>:</p>
<p><span class="math display">\[SE(\bar{x}) \approx \frac{\sigma}{\sqrt{n}}\]</span></p>
</li>
<li><p>The histogram of the sample averages is not skewed like the histogram of the population, on the contrary, it is symmetric and bell-shaped, like the normal curve.</p></li>
<li><p>The histogram of our sample of 100 resembles the population histogram.</p></li>
<li><p>Since 100 is a pretty large sample,</p></li>
</ol>
<p><span class="math display">\[
\begin{aligned}
\mu &amp;\approx \bar{x} \\
\sigma &amp;\approx s \\
\end{aligned}
\]</span></p>
<p>Up until this point, we’ve worked through this thought experiment with the unrealistic assumption that we know the population. Now we’re ready to make inferences in a setting where we <em>don’t</em> know the population.</p>
</section></section><section id="inference-for-a-population-average" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="inference-for-a-population-average">Inference for a Population Average</h2>
<p>Drawing on our understanding of the thought-experiment, we ask:</p>
<p><em>What happens when you don’t see the population, you just have your sample, and you want to make an inference about the population?</em></p>
<p>We have serious gaps in our procedure for learning about the sampling distribution!</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/triptych-sample-only.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400"></p>
</figure>
</div>
<p>To start, we know we can use the sample average, <span class="math inline">\(\bar{x}\)</span>, to infer the population average, <span class="math inline">\(\mu\)</span>. This is called a <em>point estimate</em> for the population parameter.</p>
<p>But can we do better than that? Can we bring in more of the information that we have learned from the thought-experiment? For example, can we accompany our point estimate with a sense of its accuracy? Ideally, this would be the SE of the sample mean. Unfortunately, we don’t know the SE because it depends on <span class="math inline">\(\sigma\)</span>. So now what do we do?</p>
<section id="standard-error" class="level3"><h3 class="anchored" data-anchor-id="standard-error">Standard Error</h3>
<p>The thought-experiment tells us that <span class="math inline">\(s\)</span> is close to the <span class="math inline">\(\sigma\)</span> (when you have a SRS). So we can substitute the <span class="math inline">\(s\)</span> into the formula for the SE.</p>
<p><span class="math display">\[ SE(\bar{x}) \approx \frac{s}{\sqrt{n}}\]</span></p>
<p>When presenting our findings, you might say, that based on a SRS of 100 restaurants in San Francisco, the average food safety score is estimated to be 86 with a standard error of about 1.</p>
<p>Suppose someone took a sample of 25 restaurants and provided an estimate of the average food safety score. Is that only 1/4 as accurate because the sample is 1/4 the size of ours?</p>
<p>Suppose someone took a sample of 100 restaurants in New York City where there are 50,000 restaurants (this is a made up number). Is their estimate only 1/10 as accurate because the number of units in the population is 10 times yours?</p>
<p>We can use the formula for the SE to answer these questions. In the table below, we have calculated SEs for a generic value of <span class="math inline">\(\sigma\)</span> and various choices of the population size and sample size.</p>
<table class="table">
<thead><tr class="header">
<th>Population Size (<span class="math inline">\(N\)</span>)</th>
<th></th>
<th>Sample Size (<span class="math inline">\(n\)</span>)</th>
<th></th>
</tr></thead>
<tbody>
<tr class="odd">
<td></td>
<td>25</td>
<td>100</td>
<td>400</td>
</tr>
<tr class="even">
<td>500</td>
<td><span class="math inline">\(SE = \sigma/5\)</span></td>
<td><span class="math inline">\(SE = \sigma/10\)</span></td>
<td><span class="math inline">\(SE = \sigma/20\)</span></td>
</tr>
<tr class="odd">
<td>5,000</td>
<td><span class="math inline">\(SE = \sigma/5\)</span></td>
<td><span class="math inline">\(SE = \sigma/10\)</span></td>
<td><span class="math inline">\(SE = \sigma/20\)</span></td>
</tr>
<tr class="even">
<td>50,000</td>
<td><span class="math inline">\(SE = \sigma/5\)</span></td>
<td><span class="math inline">\(SE = \sigma/ 10\)</span></td>
<td><span class="math inline">\(SE = \sigma/ 20\)</span></td>
</tr>
</tbody>
</table>
<p>What do you notice about the relationship between sample size and population size and SE?</p>
<ul>
<li>The absolute size of the population doesn’t enter into the accuracy of the estimate, as long as the sample size is small relative to the population.</li>
<li>A sample of 400 is twice as accurate as a sample of 100, which in turn is twice as accurate as a sample of 25 (assuming the population is relatively much larger than the sample). The precision of estimating the population mean improves according to the square root of the sample size.</li>
</ul></section><section id="confidence-intervals" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="confidence-intervals">Confidence Intervals</h3>
<p>Confidence intervals bring in more information from the thought-experiment. The confidence interval provides an interval estimate, instead of a point estimate, that is based on the spread of the sampling distribution of the statistic.</p>
<p>We have seen that the sampling distribution takes a familiar shape: that of the normal curve (also called the bell curve)<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. Therefore we can fill in some of the holes in the thought-experiment with approximations.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/triptych-subs.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400"></p>
</figure>
</div>
<p>This is the Central Limit Theorem in action. The CLT states that sums of random variables become normally distributed as <span class="math inline">\(n\)</span> increases. Conveniently enough, most useful statistics are some version of a sum: <span class="math inline">\(\bar{x}\)</span> is a sum divided by <span class="math inline">\(n\)</span> and <span class="math inline">\(\hat{p}\)</span> is a sum of variables that take values 0 or 1, divided by <span class="math inline">\(n\)</span>. This powerful mathematical result enables one of the most popular methods of constructing confidence intervals.</p>
<!-- #### The Normal Distribution -->
<!-- The normal distribution describes a continuous random variable that has a density function with a familiar bell shape[^normalpdf].  -->
<!-- [^normalpdf]: For a normally distributed random variable, $f(x) = \frac{1}{\sigma \sqrt{2 \pi}} e^{\frac{1}{2}\left(\frac{x-\mu}{\sigma}\right)^2}$. Read more on Wikipedia: <https://en.wikipedia.org/wiki/Normal_distribution> -->
<!-- ```{r} -->
<!-- #| warning: false -->
<!-- #| fig-width: 4 -->
<!-- #| fig-height: 2 -->
<!-- #| fig-align: center -->
<!-- data.frame(x = seq(-3, 3, .01)) %>% -->
<!--   mutate(y = dnorm(x)) %>% -->
<!--   ggplot(aes(x = x, y = y)) + -->
<!--   geom_line() + -->
<!--   labs(x = "x", -->
<!--        y = "f(x)") + -->
<!--   scale_y_continuous(breaks = NULL) + -->
<!--   theme_bw() -->
<!-- ``` -->
<!-- If a random variable $X$ follows a normal distribution, we write -->
<!-- $$X \sim \textrm{N}(\mu, \sigma)$$ -->
<!-- where $\mu$ is the mean of the distribution and $\sigma$ is its standard deviation. The particular normal distribution shown above is the *standard normal distribution*, where $\mu = 0$ and $\sigma = 1)$. -->
<!-- We can calculate the probability of any event related to $X$ by finding the area under the curve corresponding to that event. That includes the probability that $X$ falls within a particular interval. In the table below, we record the probabilities of three such intervals. -->
<!-- | Interval | Area under the normal curve | -->
<!-- | ---- | ---- | -->
<!-- | Between -1 and 1 | 0.68 | -->
<!-- | Between -1.96 and 1.96 | 0.95 | -->
<!-- | Between -2.58 and 2.58 | 0.99 | -->
<!-- So *if* we know a particular distribution is similar in shape to the normal distribution, we're able to calculate the probabilities that the random variable falls within a particular interval. With this observation in hand, let's return to the task of making an interval estimate. -->
<section id="normal-confidence-intervals" class="level4 page-columns page-full"><h4 class="anchored" data-anchor-id="normal-confidence-intervals">Normal Confidence Intervals</h4>
<p>When the sampling distribution is roughly normal in shape, then we can construct an interval that expresses exactly how much sampling variability there is. Using our single sample of data and the properties of the normal distribution, we can be 95% confident that the population parameter is within the following interval.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>The number 1.96 doesn’t come out of thin air. Refer to the notes on the <a href="../../3-probability/06-normal-approx/notes.html">Normal Distribution</a> to understand the origins.</p>
</div></div><p><span class="math display">\[[\bar{x} - 1.96 SE, \bar{x} + 1.96SE]\]</span></p>
<p>So for a sample where the sample mean is 86 and the 95% confidence interval is [84.3, 88.2 ], you would say,</p>
<blockquote class="blockquote">
<p>I am 95% confident that the population mean is between 84.3 and 88.2.</p>
</blockquote>
<p>For the particular interval that you have created, you don’t know if it contains the population mean or not. This is why we use the term <em>confidence</em> to describe it instead of probability. Probability comes into play when taking the sample, after that our confidence interval is a known observed value with nothing left to chance.</p>
<section id="confidence-not-probability" class="level5"><h5 class="anchored" data-anchor-id="confidence-not-probability">Confidence not Probability</h5>
<p>To be more precise about what is meant by “confidence”, let’s take 100 samples of size 25 from the restaurant scores, and calculate a 95% confidence interval for each of our 100 samples. How many of these 100 confidence intervals do you think will include the population mean?</p>
<p>Let’s simulate it! At the bottom of the plot below, the horizontal line at the <span class="math inline">\(y = 1\)</span> indicates the coverage of the confidence interval from the first sample. It stretches from roughly 84 to 91. The line above it at <span class="math inline">\(y = 2\)</span> indicates the coverage of the confidence interval that resulted from the second sample, from roughly 85 to 92.5. Both of these confidence intervals happened to cover the true population parameter, indicated by the black vertical line.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="notes_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<p>As we look up the graph through the remaining intervals, we see that 95 of the 100 confidence intervals cover the population parameter. This is by design. If we simulate another 100 times, we may get a different number, but it is likely to be close to 95.</p>
</section></section></section></section><section id="inference-for-a-population-proportion" class="level2"><h2 class="anchored" data-anchor-id="inference-for-a-population-proportion">Inference for a Population Proportion</h2>
<p>To gain practice with making confidence intervals, we turn to another example. This time we sample from a population where the values are 0s and 1s. You will see that the process is very much the same, although there are a few simplifications that arise due to the nature of the population.</p>
<p>Suppose we only want to eat at restaurants with food safety scores above 95. Let’s make a confidence interval for the proportion of restaurants in San Francisco with scores that are “excellent” (scores over 95). To tackle this problem, we can modify our population. Since we need only to keep track of whether a score is excellent, we can replace the scores on the tickets with 0s and 1s, where 1 indicates an excellent score. Of the 5766 restaurants in San Francisco, 1240 are excellent. We can think of our population as a box with 5766 tickets in it, and 1240 are marked 1, and 4526 are marked 0. This time let’s take a SRS of 25.</p>
<p>The thought-experiment appears as</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="notes_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
<table class="table">
<thead><tr class="header">
<th></th>
<th>Population</th>
<th>Empirical</th>
<th>Sampling</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Shape</td>
<td>left skew</td>
<td>left skew</td>
<td>bell-shaped / normal</td>
</tr>
<tr class="even">
<td>Mean</td>
<td>
<span class="math inline">\(p\)</span> = 0.22</td>
<td>
<span class="math inline">\(\hat{p}\)</span> = 0.36</td>
<td>0.22</td>
</tr>
<tr class="odd">
<td>SD</td>
<td>
<span class="math inline">\(\sigma = \sqrt{p(1-p)}\)</span> = 0.41</td>
<td>
<span class="math inline">\(s\)</span> = 0.49</td>
<td>0.08</td>
</tr>
</tbody>
</table>
<p>In the special case of a 0-1 box:</p>
<ul>
<li>The population average is the proportion of 1s in the box, let’s call this parameter <span class="math inline">\(p\)</span>.</li>
<li>The taking a draw from the population distribution taking a draw from a Bernoulli random variable, so <span class="math inline">\(\sigma = \sqrt{p(1-p)}\)</span>.</li>
<li>The sampling distribution has mean <span class="math inline">\(p\)</span>.</li>
<li>The sampling proportion, <span class="math inline">\(\hat{p}\)</span>, is similar to <span class="math inline">\(p\)</span>.</li>
<li>The SE of the sample proportion<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> is approximately <span class="math inline">\(SE(\hat{p}) = \frac{\sqrt{\hat{p}(1-\hat{p})}}{\sqrt{n}}\)</span>.</li>
</ul>
<p>With an equation to estimate <span class="math inline">\(SE\)</span> from our data in hand, we can form a 95% confidence interval.</p>
<p><span class="math display">\[\left[\hat{p} - 1.96 \frac{\sqrt{\hat{p}(1-\hat{p})}}{\sqrt{n}}, \hat{p} + 1.96 \frac{\sqrt{\hat{p}(1-\hat{p})}}{\sqrt{n}}\right]\]</span></p>
<!-- Let's make a 99% confidence interval for the proportion of restaurants with scores at least 95,  -->
<!-- [0.23, 0.49 ]. -->
</section><section id="summary" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>In these notes, we have restricted ourselves to the simple random sample, where the only source of error that we’re concerned with is sampling variability. We outlined two tools for estimating that variability: the standard error (SE) and the confidence interval.</p>
<p>We saw how the size of the sample impacts the standard error of the estimate. The larger the sample, the more accurate our estimates are and in particular the accuracy improves according to <span class="math inline">\(1/\sqrt{n}\)</span>. We also found that the size of the population doesn’t impact the accuracy, as long as the sample is small compared to the population.</p>
<p>We made confidence intervals for population averages and proportions using the normal distribution. This approach can be extended to other properties of a population, such as the median of a population, or the coefficient in a regression equation.</p>
<p>The confidence intervals that we have made are approximate in the following sense:</p>
<ul>
<li>We’re approximating the shape of the unknown sampling distribution with the normal curve.</li>
<li>The SD of the sample is used in place of the SD of the population in calculating the SE of the statistic.</li>
</ul>
<p>There are times when we are unwilling to make the assumption of normality. This is the topic of the next set of notes.</p>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class=""></span></div></div>
<!-- [I]{.dropcap}n the last set of notes, we used a thought experiment to understand the ways in which the professor calling on students from the front row could yield estimates that are in error. In this thought experiment, we had access to the population, the set of all 527 students in the class, whose distribution is shown in the top row of the plot below. The population parameter that the professor sought to learn was the mean year of those 527 students, 1.72, indicated by a gold triangle. -->
<!-- To estimate that parameter, on the first day of class the professor called on a sample of the 18 students sitting in the front row. The empirical distribution of the years of those 18 students is shown below as Sample 1. Because first year students are more eager and thus more likely to sit in the front row, it is not surprising that they were over-represented in this distribution. As a consequence, the sample mean, 1.44 (shown as a blue triangle), underestimates the population mean. -->
<!-- That selection bias, however, isn't the only source of error. Every day in class, there is some degree of randomness in which seats students sit in, so the group of students in the front row varies. Imagine on the second day, with the students in a slightly different seating configuration, the professor calls on the front row again. A different set of 18 students respond with their years; their empirical distribution shown in Sample 2. -->
<!-- The sample on day two is different from the sample on day one, so the sample mean is a bit different too: 1.39. You can imagine repeating this thought experiment on day three, and on day four, and on day five . . . each time collecting a new slightly different sample of 18 students with their own slightly different sample mean. The distribution of those sample means is the sampling distribution. -->
<!-- ```{r} -->
<!-- library(tidyverse) -->
<!-- pop_eager <- data.frame(year = rep(c(1, 2, 3, 4),  -->
<!--                                    times = c(245, 210, 47, 25)), -->
<!--                         eagerness = rep(c(10, 6, 3, 1),  -->
<!--                                         times = c(245, 210, 47, 25))) -->
<!-- set.seed(55) -->
<!-- pop_eager <- pop_eager %>% -->
<!--   slice_sample(n = nrow(pop_eager))  -->
<!-- mu <- mean(pop_eager$year) -->
<!-- p_pop <- pop_eager %>% -->
<!--   ggplot(aes(x = year)) + -->
<!--   geom_bar(fill = "purple") + -->
<!--   labs(title = "Population Distribution", -->
<!--        y = "") + -->
<!--   annotate("point", x = mu, y = -20, shape = 17, size = 5, color = "goldenrod2") + -->
<!--   theme_gray(base_size = 10) + -->
<!--   theme(plot.title = element_text(size=10)) -->
<!-- library(infer) -->
<!-- samp_1 <- pop_eager %>% -->
<!--   slice_sample(n = 18, -->
<!--                    replace = FALSE, -->
<!--                    weight_by = eagerness)  -->
<!-- many_samps <- samp_1 %>% -->
<!--   mutate(Sample = 1) -->
<!-- for (i in 2:500) { -->
<!--   many_samps <- pop_eager %>% -->
<!--     slice_sample(n = 18, -->
<!--                  replace = FALSE, -->
<!--                  weight_by = eagerness) %>% -->
<!--     mutate(Sample = i ) %>% -->
<!--     bind_rows(many_samps) -->
<!-- } -->
<!-- xbar1 <- many_samps %>% -->
<!--   filter(Sample == 1) %>% -->
<!--   summarize(mean(year)) %>% -->
<!--   pull() -->
<!-- xbar2 <- many_samps %>% -->
<!--   filter(Sample == 2) %>% -->
<!--   summarize(mean(year)) %>% -->
<!--   pull() -->
<!-- xbar3 <- many_samps %>% -->
<!--   filter(Sample == 3) %>% -->
<!--   summarize(mean(year)) %>% -->
<!--   pull() -->
<!-- p1 <- many_samps %>% -->
<!--   filter(Sample == 1) %>% -->
<!--   ggplot(aes(x = year)) +  -->
<!--   geom_bar() + -->
<!--   labs(title = "Sample 1", -->
<!--        y = "") + -->
<!--   annotate("point", x = xbar1, y = 0, shape = 17,  -->
<!--            size = 4, color = "steelblue") + -->
<!--   theme_gray(base_size = 10) + -->
<!--   theme(plot.title = element_text(size=10)) -->
<!-- p2 <- many_samps %>% -->
<!--   filter(Sample == 2) %>% -->
<!--   ggplot(aes(x = year)) +  -->
<!--   geom_bar() + -->
<!--   labs(title = "Sample 2", -->
<!--        y = "") + -->
<!--   annotate("point", x = xbar2, y = 0, shape = 17,  -->
<!--            size = 4, color = "steelblue") + -->
<!--   theme_gray(base_size = 10) + -->
<!--   theme(plot.title = element_text(size=10)) -->
<!-- p3 <- many_samps %>% -->
<!--   filter(Sample == 3) %>% -->
<!--   ggplot(aes(x = year)) +  -->
<!--   geom_bar() + -->
<!--   labs(title = "Sample 3", -->
<!--        y = "") + -->
<!--   annotate("point", x = xbar3, y = 0, shape = 17,  -->
<!--            size = 4, color = "steelblue") + -->
<!--   theme_gray(base_size = 10) + -->
<!--   theme(plot.title = element_text(size=10)) -->
<!-- # fix limits -->
<!-- xlims_from_samps <- list(ggplot_build(p1)$layout$panel_scales_x[[1]]$range$range, -->
<!--            ggplot_build(p2)$layout$panel_scales_x[[1]]$range$range, -->
<!--            ggplot_build(p3)$layout$panel_scales_x[[1]]$range$range) -->
<!-- max_xlims <- unlist(xlims_from_samps[which.max(lapply(xlims_from_samps, diff))]) -->
<!-- ylims_from_samps <- list(ggplot_build(p1)$layout$panel_scales_y[[1]]$range$range, -->
<!--            ggplot_build(p2)$layout$panel_scales_y[[1]]$range$range, -->
<!--            ggplot_build(p3)$layout$panel_scales_y[[1]]$range$range) -->
<!-- max_ylims <- unlist(ylims_from_samps[which.max(lapply(ylims_from_samps, diff))]) -->
<!-- p1 <- p1 + -->
<!--   lims(x = max_xlims, -->
<!--        y = max_ylims) -->
<!-- p2 <- p2 + -->
<!--   lims(x = max_xlims, -->
<!--        y = max_ylims) -->
<!-- p3 <- p3 + -->
<!--   lims(x = max_xlims, -->
<!--        y = max_ylims) -->
<!-- sample_labels <- c("1" = "Sample 1", -->
<!--                    "2" = "Sample 2", -->
<!--                    "3" = "Sample 3") -->
<!-- p_samps <- many_samps %>% -->
<!--   filter(Sample %in% 1:3) %>% -->
<!--   ggplot(aes(x = year)) +  -->
<!--   geom_bar() + -->
<!--   labs(y = "") + -->
<!--   facet_wrap(vars(Sample), -->
<!--              labeller = labeller(Sample = sample_labels)) + -->
<!--   theme_gray(base_size = 10) -->
<!-- many_xbars <- many_samps %>% -->
<!--   group_by(Sample) %>% -->
<!--   summarize(xbar = mean(as.numeric(year))) -->
<!-- xlims_from_pop <- ggplot_build(p_pop)$layout$panel_scales_x[[1]]$range$range -->
<!-- p_samp_dist <- many_xbars %>% -->
<!--   ggplot(aes(x = xbar)) + -->
<!--   geom_bar(fill = "steelblue") + -->
<!--   lims(x = c(0, 4)) + -->
<!--   labs(title = "Sampling Distribution", -->
<!--        y = "", -->
<!--        x = expression(paste(bar(x), " (mean year)"))) + -->
<!--   annotate("point", x = mu, y = -10, shape = 17, size = 5, color = "goldenrod2") + -->
<!--   theme_gray(base_size = 10) + -->
<!--   theme(plot.title = element_text(size=10)) + -->
<!--   lims(x = xlims_from_pop) -->
<!-- library(patchwork) -->
<!-- triptych <- (plot_spacer() + p_pop + plot_spacer()) /  -->
<!--   (p1 + p2 + p3) /  -->
<!--   (plot_spacer() + p_samp_dist + plot_spacer()) -->
<!-- triptych -->
<!-- ``` -->
<!-- This sampling distribution contains 500 sample means. The selection bias in calling only on the front row -->


</section><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>
<ol>
<li id="fn1"><p>The terms <em>census</em> refers to a setting where you have access to the entire population.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2">
<p>This approximation becomes equality for a random sample <em>with replacement</em>. When we have a SRS, the exact formula is <span class="math inline">\(SE(\bar{x}) = \sqrt{\frac{N-n}{N-1}} \sigma/\sqrt{n}\)</span>.</p>
<p>This additional term, called the <em>finite population correction factor</em>, adjusts for the fact that we are drawing without replacement. Here <span class="math inline">\(N\)</span> is the number of tickets in the box (the size of the population) and <span class="math inline">\(n\)</span> is the number of tickets drawn from the box (the size of the sample).</p>
<p>To help make sense of this correction factor, think about the following two cases:</p>
<ul>
<li>Draw <span class="math inline">\(N\)</span> tickets from the box (that is, <span class="math inline">\(n = N\)</span>).</li>
<li>Draw only one ticket from the box.</li>
</ul>
<p>What happens to the SE in these two extreme cases?</p>
<p>In the first case, you will always see the entire population if you are drawing without replacement. So, the sample mean will exactly match the population mean. The sampling distribution has no variation, so <span class="math inline">\(SE = 0\)</span>.</p>
<p>In the second case, since you take only one draw from the box, it doesn’t matter if you replace it or not. So the SE for a SRS should match the SE when sampling with replacement in this special case. In settings when <span class="math inline">\(N\)</span> is large relative to <span class="math inline">\(n\)</span>, it effectively behaves as if you are sampling with replacement.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p>
</li>
<li id="fn3"><p>This is not always the case. We’ll come back to this point later.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4">
<p>This calculation results from casting the total number of 1’s in a sample of size <span class="math inline">\(n\)</span> as a binomial random variable with success probability <span class="math inline">\(p\)</span>. Call that random variable <span class="math inline">\(Y\)</span>. The variance of a binomial random variable is <span class="math inline">\(Var(Y) = np(1-p)\)</span>. Observing that sample proportion can be considered a binomial count divided by <span class="math inline">\(n\)</span>, and applying the properties of variance, we can find the variance of <span class="math inline">\(\hat{p}\)</span> as,</p>
<p><span class="math display">\[\begin{eqnarray}
Var(\hat{p}) &amp;= Var(\frac{1}{n}Y) \\
&amp;= \frac{1}{n^2}Var(Y) \\
&amp;= \frac{1}{n^2}np(1-p) \\
&amp;= \frac{p(1-p)}{n}
\end{eqnarray}\]</span></p>
<p>So the standard error can be calculated as:</p>
<p><span class="math display">\[\begin{eqnarray}
SE(\hat{p}) &amp;= \sqrt{Var(\hat{p})} = \sqrt{\frac{p(1-p)}{n}}
\end{eqnarray}\]</span></p>
<p>When estimating the SE from data, we plug in <span class="math inline">\(\hat{p}\)</span> for <span class="math inline">\(p\)</span>.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p>
</li>
</ol></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../4-generalization/01-sampling-distributions/notes.html" class="pagination-link  aria-label=" from="" samples="" to="" populations="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">From Samples to Populations</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../4-generalization/03-bootstrapping/notes.html" class="pagination-link" aria-label="Bootstrapping">
        <span class="nav-page-text">Bootstrapping</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
    <a class="nav-link" href="https://www.netlify.com/">
<p>This site is hosted by Netlify.</p>
</a>
  </li>  
</ul>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
    <a class="nav-link" href="../../license.html">
<p>License</p>
</a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>